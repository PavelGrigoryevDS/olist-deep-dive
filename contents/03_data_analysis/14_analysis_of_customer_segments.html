
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Analysis of Customer Segments &#8212; 🌊 Deep Sales Analysis of Olist Marketplace</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=aa5847ba" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/custom.js?v=f9582d1e"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/03_data_analysis/14_analysis_of_customer_segments';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="RFM Analysis" href="15_rfm_analysis.html" />
    <link rel="prev" title="Slice Analysis" href="13_slice_analysis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo-light.png" class="logo__image only-light" alt="🌊 Deep Sales Analysis of Olist Marketplace - Home"/>
    <script>document.write(`<img src="../../_static/logo-dark.png" class="logo__image only-dark" alt="🌊 Deep Sales Analysis of Olist Marketplace - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    🌊 Deep Sales Analysis of Olist
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Description and Exploration</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_data_description_and_exploration/01_data_description.html">Data Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_data_description_and_exploration/02_data_loading.html">Data Loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_data_description_and_exploration/03_data_exploration.html">Data Exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_data_description_and_exploration/04_intermediate_conclusion.html">Intermediate Conclusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Preprocessing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/01_initial_data_filtering.html">Initial Data Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/02_outlier_handling.html">Outlier Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/03_missing_value_handling.html">Missing Value Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/04_duplicate_handling.html">Duplicate Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/05_creating_new_metrics.html">Creating New Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/06_creating_new_dimensions.html">Creating New Dimensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/07_converting_data_to_a_convenient_format.html">Converting Data to a Convenient Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/08_data_merging.html">Data Merging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_data_preprocessing/09_intermediate_conclusion.html">Intermediate Conclusion</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_creating_analysis_class.html">Creating Analysis Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_time_series_analysis.html">Time Series Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_customer_analysis.html">Customer Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_seller_analysis.html">Seller Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_sales_analysis.html">Sales Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_product_analysis.html">Product Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_review_analysis.html">Review Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_delivery_analysis.html">Delivery Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_payment_analysis.html">Payment Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_geographical_analysis.html">Geographical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="11_cohort_analysis.html">Cohort Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_correlation_analysis.html">Correlation Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_slice_analysis.html">Slice Analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Analysis of Customer Segments</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_rfm_analysis.html">RFM Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_customer_clustering.html">Customer Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="17_hypothesis_testing.html">Hypothesis Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">General Conclusion</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/01_time_dynamics.html">Time Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/02_customers.html">Customers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/03_sales.html">Sales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/04_products.html">Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/05_reviews.html">Reviews</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/06_delivery.html">Delivery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/07_payments.html">Payments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/08_sellers.html">Sellers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/09_cohort_analysis.html">Cohort Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/10_correlation_analysis.html">Correlation Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/11_black_friday.html">Black Friday</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/12_cancelled_orders.html">Cancelled Orders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/13_hypothesis_testing_results.html">Hypothesis Testing Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_general_conclusion/14_detected_anomalies.html">Detected Anomalies</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Recommendations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/01_product_market_fit.html">Product market fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/02_customer_loyalty_enhancement.html">Customer loyalty Enhancement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/03_customer_experience_improvement.html">Customer Experience Improvement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/04_logistics_and_delivery_optimization.html">Logistics and Delivery Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/05_financial_optimization.html">Financial optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/06_average_order_value_and_basket_optimization.html">Average Order Value and Basket Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/07_segment_specific_strategies.html">Segment-Specific Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/08_product_and_assortment_management.html">Product and Assortment Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/09_marketing_and_promotion.html">Marketing and Promotion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/10_peak_season_preparedness.html">Peak Season Preparedness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/11_analytics_and_monitoring.html">Analytics and Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/12_ab_testing.html">A/B Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_recommendations/13_anomaly.html">Anomaly</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/PavelGrigoryevDS/olist-deep-dive" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/contents/03_data_analysis/14_analysis_of_customer_segments.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analysis of Customer Segments</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> On this page </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-customers-by-segments">Distribution of Customers by Segments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customer-profiling">Customer Profiling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pairwise-segment-combinations">Pairwise Segment Combinations</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analysis-of-customer-segments">
<h1>Analysis of Customer Segments<a class="headerlink" href="#analysis-of-customer-segments" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df_customers</span>
    <span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">metric_label</span> <span class="o">=</span> <span class="s1">&#39;Share of Customers&#39;</span>
    <span class="p">,</span> <span class="n">agg_func</span> <span class="o">=</span> <span class="s1">&#39;nunique&#39;</span>
    <span class="p">,</span> <span class="n">norm_by</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>
    <span class="p">,</span> <span class="n">axis_sort_order</span><span class="o">=</span><span class="s1">&#39;descending&#39;</span>    
    <span class="p">,</span> <span class="n">text_auto</span><span class="o">=</span><span class="s1">&#39;.1%&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Save customer metrics in a separate list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">customers_dim</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;activity_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;value_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;purchase_freq_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;repeat_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;loyalty_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;risk_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;weekday_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;installment_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;products_cnt_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;weight_segment&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;customer_top_purchase_weekdays&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;customer_payment_types&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;customer_top_product_categories&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;customer_top_general_product_categories&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;customer_city&quot;</span>
    <span class="p">,</span> <span class="s2">&quot;customer_state&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="distribution-of-customers-by-segments">
<h2>Distribution of Customers by Segments<a class="headerlink" href="#distribution-of-customers-by-segments" title="Link to this heading">#</a></h2>
<p>Examine how customers are distributed across each segment and compare key metrics between segments.</p>
<p>Select the following key customer metrics.</p>
<ul class="simple">
<li><p>total_customer_payment</p></li>
<li><p>avg_total_order_payment</p></li>
<li><p>buys_cnt</p></li>
<li><p>from_first_to_last_days</p></li>
<li><p>customer_avg_reviews_score</p></li>
<li><p>avg_products_cnt</p></li>
<li><p>avg_delivery_delay_days</p></li>
<li><p>avg_order_total_weight_kg</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;total_customer_payment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_total_order_payment&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;buys_cnt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;from_first_to_last_days&#39;</span><span class="p">,</span>
    <span class="s1">&#39;customer_avg_reviews_score&#39;</span><span class="p">,</span>
    <span class="s1">&#39;canceled_share&#39;</span><span class="p">,</span>
    <span class="s1">&#39;purchase_weekend_share&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_products_cnt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_delivery_delay_days&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_order_total_weight_kg&#39;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Give more readable names for the metrics on the graphs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metric_labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;total_customer_payment&#39;</span><span class="p">:</span> <span class="s1">&#39;Total Spending&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_total_order_payment&#39;</span><span class="p">:</span> <span class="s1">&#39;Average Order Value&#39;</span><span class="p">,</span>
    <span class="s1">&#39;buys_cnt&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of Purchases&#39;</span><span class="p">,</span>
    <span class="s1">&#39;from_first_to_last_days&#39;</span><span class="p">:</span> <span class="s1">&#39;Customer Lifetime&#39;</span><span class="p">,</span>
    <span class="s1">&#39;customer_avg_reviews_score&#39;</span><span class="p">:</span> <span class="s1">&#39;Average Rating&#39;</span><span class="p">,</span>
    <span class="s1">&#39;canceled_share&#39;</span><span class="p">:</span> <span class="s1">&#39;Order Cancelation Rate&#39;</span><span class="p">,</span>
    <span class="s1">&#39;purchase_weekend_share&#39;</span><span class="p">:</span> <span class="s1">&#39;Weekend Purchase Ratio&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_products_cnt&#39;</span><span class="p">:</span> <span class="s1">&#39;Average Items per Order&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_delivery_delay_days&#39;</span><span class="p">:</span> <span class="s1">&#39;Avg Delivery Delay&#39;</span><span class="p">,</span>
    <span class="s1">&#39;avg_order_total_weight_kg&#39;</span><span class="p">:</span> <span class="s1">&#39;Avg Order Weight&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels_for_polar</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">base_labels</span><span class="p">,</span> <span class="o">**</span><span class="n">metric_labels</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p><strong>By Activity Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;activity_segment&#39;</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;activity_segment&#39;</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_2f3e1 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_2f3e1 th {
  border: 1px solid black;
}
#T_2f3e1_row0_col0, #T_2f3e1_row1_col3, #T_2f3e1_row2_col2, #T_2f3e1_row3_col3, #T_2f3e1_row4_col2, #T_2f3e1_row5_col1, #T_2f3e1_row5_col2, #T_2f3e1_row6_col0, #T_2f3e1_row6_col1, #T_2f3e1_row6_col2, #T_2f3e1_row6_col3, #T_2f3e1_row6_col4, #T_2f3e1_row7_col1, #T_2f3e1_row7_col2, #T_2f3e1_row7_col3, #T_2f3e1_row8_col0, #T_2f3e1_row8_col1, #T_2f3e1_row8_col2, #T_2f3e1_row8_col3, #T_2f3e1_row9_col0, #T_2f3e1_row10_col3 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row0_col1, #T_2f3e1_row0_col2 {
  background-color: rgb(243,249,242);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row0_col3, #T_2f3e1_row1_col0, #T_2f3e1_row2_col0, #T_2f3e1_row3_col0, #T_2f3e1_row4_col0, #T_2f3e1_row5_col3, #T_2f3e1_row7_col0, #T_2f3e1_row9_col3, #T_2f3e1_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row0_col4 {
  background-color: rgb(240,247,239);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row1_col1 {
  background-color: rgb(152,181,161);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row1_col2 {
  background-color: rgb(169,194,176);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row1_col4, #T_2f3e1_row2_col4, #T_2f3e1_row3_col4, #T_2f3e1_row4_col3, #T_2f3e1_row4_col4, #T_2f3e1_row5_col4, #T_2f3e1_row7_col4, #T_2f3e1_row8_col4, #T_2f3e1_row9_col4, #T_2f3e1_row10_col4 {
  background-color: white;
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row2_col1 {
  background-color: rgb(135,168,146);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row2_col3 {
  background-color: rgb(225,236,226);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row3_col1, #T_2f3e1_row3_col2 {
  background-color: rgb(123,160,136);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row4_col1 {
  background-color: rgb(95,139,111);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row5_col0 {
  background-color: rgb(163,189,170);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row9_col1 {
  background-color: rgb(30,91,54);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row9_col2 {
  background-color: rgb(70,120,89);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_2f3e1_row10_col1, #T_2f3e1_row10_col2 {
  background-color: rgb(75,124,93);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_2f3e1">
  <caption>Segment Analysis for Activity Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >activity_segment</th>
      <th id="T_2f3e1_level0_col0" class="col_heading level0 col0" >Core</th>
      <th id="T_2f3e1_level0_col1" class="col_heading level0 col1" >Potential Core</th>
      <th id="T_2f3e1_level0_col2" class="col_heading level0 col2" >Short-Lived Repeat</th>
      <th id="T_2f3e1_level0_col3" class="col_heading level0 col3" >One Time</th>
      <th id="T_2f3e1_level0_col4" class="col_heading level0 col4" >Never Converted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_2f3e1_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_2f3e1_row0_col0" class="data row0 col0" >0.16%</td>
      <td id="T_2f3e1_row0_col1" class="data row0 col1" >1.35%</td>
      <td id="T_2f3e1_row0_col2" class="data row0 col2" >1.40%</td>
      <td id="T_2f3e1_row0_col3" class="data row0 col3" >94.43%</td>
      <td id="T_2f3e1_row0_col4" class="data row0 col4" >2.65%</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_2f3e1_row1_col0" class="data row1 col0" >431.98</td>
      <td id="T_2f3e1_row1_col1" class="data row1 col1" >230.84</td>
      <td id="T_2f3e1_row1_col2" class="data row1 col2" >207.61</td>
      <td id="T_2f3e1_row1_col3" class="data row1 col3" >105.40</td>
      <td id="T_2f3e1_row1_col4" class="data row1 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_2f3e1_row2_col0" class="data row2 col0" >127.38</td>
      <td id="T_2f3e1_row2_col1" class="data row2 col1" >114.19</td>
      <td id="T_2f3e1_row2_col2" class="data row2 col2" >103.31</td>
      <td id="T_2f3e1_row2_col3" class="data row2 col3" >105.40</td>
      <td id="T_2f3e1_row2_col4" class="data row2 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_2f3e1_row3_col0" class="data row3 col0" >3.00</td>
      <td id="T_2f3e1_row3_col1" class="data row3 col1" >2.00</td>
      <td id="T_2f3e1_row3_col2" class="data row3 col2" >2.00</td>
      <td id="T_2f3e1_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_2f3e1_row3_col4" class="data row3 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_2f3e1_row4_col0" class="data row4 col0" >206.22</td>
      <td id="T_2f3e1_row4_col1" class="data row4 col1" >126.08</td>
      <td id="T_2f3e1_row4_col2" class="data row4 col2" >0.00</td>
      <td id="T_2f3e1_row4_col3" class="data row4 col3" >NaN</td>
      <td id="T_2f3e1_row4_col4" class="data row4 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_2f3e1_row5_col0" class="data row5 col0" >4.67</td>
      <td id="T_2f3e1_row5_col1" class="data row5 col1" >4.50</td>
      <td id="T_2f3e1_row5_col2" class="data row5 col2" >4.50</td>
      <td id="T_2f3e1_row5_col3" class="data row5 col3" >5.00</td>
      <td id="T_2f3e1_row5_col4" class="data row5 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_2f3e1_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_2f3e1_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_2f3e1_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_2f3e1_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_2f3e1_row6_col4" class="data row6 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_2f3e1_row7_col0" class="data row7 col0" >0.23</td>
      <td id="T_2f3e1_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_2f3e1_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_2f3e1_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_2f3e1_row7_col4" class="data row7 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_2f3e1_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_2f3e1_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_2f3e1_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_2f3e1_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_2f3e1_row8_col4" class="data row8 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_2f3e1_row9_col0" class="data row9 col0" >-12.69</td>
      <td id="T_2f3e1_row9_col1" class="data row9 col1" >-11.71</td>
      <td id="T_2f3e1_row9_col2" class="data row9 col2" >-11.89</td>
      <td id="T_2f3e1_row9_col3" class="data row9 col3" >-11.57</td>
      <td id="T_2f3e1_row9_col4" class="data row9 col4" >NaN</td>
    </tr>
    <tr>
      <th id="T_2f3e1_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_2f3e1_row10_col0" class="data row10 col0" >1.11</td>
      <td id="T_2f3e1_row10_col1" class="data row10 col1" >1.00</td>
      <td id="T_2f3e1_row10_col2" class="data row10 col2" >1.00</td>
      <td id="T_2f3e1_row10_col3" class="data row10 col3" >0.75</td>
      <td id="T_2f3e1_row10_col4" class="data row10 col4" >NaN</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/4d68cd4622eb27eca97af9dccc53301f9da66714910f82000e9ecfb474416488.jpg" src="../../_images/4d68cd4622eb27eca97af9dccc53301f9da66714910f82000e9ecfb474416488.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>3% of all customers made no successful purchases</p></li>
<li><p>94% of successful customers made only one purchase</p></li>
<li><p>1% in Potential Core segment</p></li>
<li><p>1% in Short-Lived Repeat segment</p></li>
<li><p>Core audience segment is less than 1%</p></li>
<li><p>Highest metric values in Core segment, followed by Potential Core</p></li>
<li><p>Median review score is higher for one-time purchasers</p></li>
<li><p>Core segment has best delivery time performance, One Time has worst</p></li>
</ul>
<p>We will not consider the segment of customers who did not make any successful purchases, as their values will be repetitive.</p>
<p><strong>By Purchase Amount Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;value_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;value_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_4e767 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_4e767 th {
  border: 1px solid black;
}
#T_4e767_row0_col0 {
  background-color: rgb(246,251,244);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_4e767_row0_col1, #T_4e767_row1_col0, #T_4e767_row2_col0, #T_4e767_row4_col0, #T_4e767_row9_col2, #T_4e767_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_4e767_row0_col2, #T_4e767_row1_col2, #T_4e767_row2_col2, #T_4e767_row3_col0, #T_4e767_row3_col1, #T_4e767_row3_col2, #T_4e767_row4_col2, #T_4e767_row5_col0, #T_4e767_row5_col1, #T_4e767_row5_col2, #T_4e767_row6_col0, #T_4e767_row6_col1, #T_4e767_row6_col2, #T_4e767_row7_col0, #T_4e767_row7_col1, #T_4e767_row7_col2, #T_4e767_row8_col0, #T_4e767_row8_col1, #T_4e767_row8_col2, #T_4e767_row9_col0, #T_4e767_row10_col2 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_4e767_row1_col1 {
  background-color: rgb(179,201,185);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_4e767_row2_col1 {
  background-color: rgb(177,199,183);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_4e767_row4_col1 {
  background-color: rgb(144,175,154);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_4e767_row9_col1 {
  background-color: rgb(215,228,217);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_4e767_row10_col1 {
  background-color: rgb(162,189,170);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_4e767">
  <caption>Segment Analysis for Value Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >value_segment</th>
      <th id="T_4e767_level0_col0" class="col_heading level0 col0" >High</th>
      <th id="T_4e767_level0_col1" class="col_heading level0 col1" >Medium</th>
      <th id="T_4e767_level0_col2" class="col_heading level0 col2" >Low</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_4e767_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_4e767_row0_col0" class="data row0 col0" >24.40%</td>
      <td id="T_4e767_row0_col1" class="data row0 col1" >48.63%</td>
      <td id="T_4e767_row0_col2" class="data row0 col2" >24.31%</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_4e767_row1_col0" class="data row1 col0" >276.11</td>
      <td id="T_4e767_row1_col1" class="data row1 col1" >107.78</td>
      <td id="T_4e767_row1_col2" class="data row1 col2" >44.00</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_4e767_row2_col0" class="data row2 col0" >263.85</td>
      <td id="T_4e767_row2_col1" class="data row2 col1" >106.29</td>
      <td id="T_4e767_row2_col2" class="data row2 col2" >44.00</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_4e767_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_4e767_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_4e767_row3_col2" class="data row3 col2" >1.00</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_4e767_row4_col0" class="data row4 col0" >45.81</td>
      <td id="T_4e767_row4_col1" class="data row4 col1" >21.27</td>
      <td id="T_4e767_row4_col2" class="data row4 col2" >3.86</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_4e767_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_4e767_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_4e767_row5_col2" class="data row5 col2" >5.00</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_4e767_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_4e767_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_4e767_row6_col2" class="data row6 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_4e767_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_4e767_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_4e767_row7_col2" class="data row7 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_4e767_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_4e767_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_4e767_row8_col2" class="data row8 col2" >1.00</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_4e767_row9_col0" class="data row9 col0" >-12.24</td>
      <td id="T_4e767_row9_col1" class="data row9 col1" >-12.03</td>
      <td id="T_4e767_row9_col2" class="data row9 col2" >-10.60</td>
    </tr>
    <tr>
      <th id="T_4e767_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_4e767_row10_col0" class="data row10 col0" >2.30</td>
      <td id="T_4e767_row10_col1" class="data row10 col1" >0.95</td>
      <td id="T_4e767_row10_col2" class="data row10 col2" >0.25</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/c67b2d354a8105b98699e6464b5b6e5b1f4841a3b8314224b68951dd59867f9b.jpg" src="../../_images/c67b2d354a8105b98699e6464b5b6e5b1f4841a3b8314224b68951dd59867f9b.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>49% of customers are in medium payment tier</p></li>
<li><p>24% in high payment tier, 24% in low</p></li>
<li><p>High payment tier spends most (expected)</p></li>
<li><p>No difference in median review scores across tiers</p></li>
<li><p>High payment tier has higher median order weight</p></li>
</ul>
<p><strong>By Purchase Frequency Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;purchase_freq_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">,</span> <span class="s1">&#39;Non-Repeating&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;purchase_freq_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_89811 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_89811 th {
  border: 1px solid black;
}
#T_89811_row0_col0, #T_89811_row0_col1, #T_89811_row0_col2 {
  background-color: rgb(246,251,244);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row0_col3, #T_89811_row1_col5, #T_89811_row2_col4, #T_89811_row3_col5, #T_89811_row4_col4, #T_89811_row5_col0, #T_89811_row5_col1, #T_89811_row5_col3, #T_89811_row5_col4, #T_89811_row6_col0, #T_89811_row6_col1, #T_89811_row6_col2, #T_89811_row6_col3, #T_89811_row6_col4, #T_89811_row6_col5, #T_89811_row7_col0, #T_89811_row7_col1, #T_89811_row7_col2, #T_89811_row7_col3, #T_89811_row7_col4, #T_89811_row7_col5, #T_89811_row8_col0, #T_89811_row8_col1, #T_89811_row8_col2, #T_89811_row8_col3, #T_89811_row8_col4, #T_89811_row8_col5, #T_89811_row9_col2, #T_89811_row10_col5 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row0_col4 {
  background-color: rgb(245,250,243);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row0_col5, #T_89811_row1_col1, #T_89811_row2_col1, #T_89811_row3_col0, #T_89811_row3_col1, #T_89811_row3_col2, #T_89811_row3_col3, #T_89811_row3_col4, #T_89811_row4_col2, #T_89811_row5_col5, #T_89811_row9_col0, #T_89811_row10_col1 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row1_col0 {
  background-color: rgb(1,69,28);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row1_col2 {
  background-color: rgb(34,93,57);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row1_col3 {
  background-color: rgb(23,85,47);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row1_col4 {
  background-color: rgb(83,130,100);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row2_col0 {
  background-color: rgb(9,75,35);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row2_col2 {
  background-color: rgb(46,102,68);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row2_col3 {
  background-color: rgb(45,101,67);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row2_col5 {
  background-color: rgb(163,189,171);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row4_col0 {
  background-color: rgb(192,211,196);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row4_col1, #T_89811_row9_col4 {
  background-color: rgb(124,160,136);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row4_col3 {
  background-color: rgb(230,240,230);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row4_col5 {
  background-color: white;
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row5_col2 {
  background-color: rgb(83,130,101);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row9_col1 {
  background-color: rgb(104,146,119);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row9_col3 {
  background-color: rgb(88,134,105);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row9_col5 {
  background-color: rgb(64,116,83);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row10_col0 {
  background-color: rgb(46,102,67);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row10_col2 {
  background-color: rgb(108,148,122);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row10_col3 {
  background-color: rgb(15,79,40);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_89811_row10_col4 {
  background-color: rgb(61,114,81);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_89811">
  <caption>Segment Analysis for Purchase Freq Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >purchase_freq_segment</th>
      <th id="T_89811_level0_col0" class="col_heading level0 col0" >Quarterly</th>
      <th id="T_89811_level0_col1" class="col_heading level0 col1" >Semiannual</th>
      <th id="T_89811_level0_col2" class="col_heading level0 col2" >Annual</th>
      <th id="T_89811_level0_col3" class="col_heading level0 col3" >Monthly</th>
      <th id="T_89811_level0_col4" class="col_heading level0 col4" >Weekly</th>
      <th id="T_89811_level0_col5" class="col_heading level0 col5" >Non-Repeating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_89811_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_89811_row0_col0" class="data row0 col0" >0.56%</td>
      <td id="T_89811_row0_col1" class="data row0 col1" >0.45%</td>
      <td id="T_89811_row0_col2" class="data row0 col2" >0.48%</td>
      <td id="T_89811_row0_col3" class="data row0 col3" >0.41%</td>
      <td id="T_89811_row0_col4" class="data row0 col4" >1.01%</td>
      <td id="T_89811_row0_col5" class="data row0 col5" >94.43%</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_89811_row1_col0" class="data row1 col0" >247.41</td>
      <td id="T_89811_row1_col1" class="data row1 col1" >248.52</td>
      <td id="T_89811_row1_col2" class="data row1 col2" >228.49</td>
      <td id="T_89811_row1_col3" class="data row1 col3" >234.81</td>
      <td id="T_89811_row1_col4" class="data row1 col4" >200.29</td>
      <td id="T_89811_row1_col5" class="data row1 col5" >105.40</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_89811_row2_col0" class="data row2 col0" >116.35</td>
      <td id="T_89811_row2_col1" class="data row2 col1" >117.04</td>
      <td id="T_89811_row2_col2" class="data row2 col2" >113.71</td>
      <td id="T_89811_row2_col3" class="data row2 col3" >113.81</td>
      <td id="T_89811_row2_col4" class="data row2 col4" >99.45</td>
      <td id="T_89811_row2_col5" class="data row2 col5" >105.40</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_89811_row3_col0" class="data row3 col0" >2.00</td>
      <td id="T_89811_row3_col1" class="data row3 col1" >2.00</td>
      <td id="T_89811_row3_col2" class="data row3 col2" >2.00</td>
      <td id="T_89811_row3_col3" class="data row3 col3" >2.00</td>
      <td id="T_89811_row3_col4" class="data row3 col4" >2.00</td>
      <td id="T_89811_row3_col5" class="data row3 col5" >1.00</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_89811_row4_col0" class="data row4 col0" >59.66</td>
      <td id="T_89811_row4_col1" class="data row4 col1" >134.01</td>
      <td id="T_89811_row4_col2" class="data row4 col2" >269.91</td>
      <td id="T_89811_row4_col3" class="data row4 col3" >17.52</td>
      <td id="T_89811_row4_col4" class="data row4 col4" >0.00</td>
      <td id="T_89811_row4_col5" class="data row4 col5" >NaN</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_89811_row5_col0" class="data row5 col0" >4.50</td>
      <td id="T_89811_row5_col1" class="data row5 col1" >4.50</td>
      <td id="T_89811_row5_col2" class="data row5 col2" >4.83</td>
      <td id="T_89811_row5_col3" class="data row5 col3" >4.50</td>
      <td id="T_89811_row5_col4" class="data row5 col4" >4.50</td>
      <td id="T_89811_row5_col5" class="data row5 col5" >5.00</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_89811_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_89811_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_89811_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_89811_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_89811_row6_col4" class="data row6 col4" >0.00</td>
      <td id="T_89811_row6_col5" class="data row6 col5" >0.00</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_89811_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_89811_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_89811_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_89811_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_89811_row7_col4" class="data row7 col4" >0.00</td>
      <td id="T_89811_row7_col5" class="data row7 col5" >0.00</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_89811_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_89811_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_89811_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_89811_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_89811_row8_col4" class="data row8 col4" >1.00</td>
      <td id="T_89811_row8_col5" class="data row8 col5" >1.00</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_89811_row9_col0" class="data row9 col0" >-11.17</td>
      <td id="T_89811_row9_col1" class="data row9 col1" >-11.82</td>
      <td id="T_89811_row9_col2" class="data row9 col2" >-12.70</td>
      <td id="T_89811_row9_col3" class="data row9 col3" >-11.72</td>
      <td id="T_89811_row9_col4" class="data row9 col4" >-11.94</td>
      <td id="T_89811_row9_col5" class="data row9 col5" >-11.57</td>
    </tr>
    <tr>
      <th id="T_89811_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_89811_row10_col0" class="data row10 col0" >1.01</td>
      <td id="T_89811_row10_col1" class="data row10 col1" >1.07</td>
      <td id="T_89811_row10_col2" class="data row10 col2" >0.93</td>
      <td id="T_89811_row10_col3" class="data row10 col3" >1.05</td>
      <td id="T_89811_row10_col4" class="data row10 col4" >0.99</td>
      <td id="T_89811_row10_col5" class="data row10 col5" >0.75</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/22ed71f8c78640eb7f5a13f0662a773e3b744e9e3e6a36e2c41e015d9cb41505.jpg" src="../../_images/22ed71f8c78640eb7f5a13f0662a773e3b744e9e3e6a36e2c41e015d9cb41505.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Among repeat buyers:</p>
<ul>
<li><p>Weekly purchasers: 1% (most common frequency)</p></li>
<li><p>Quarterly/Semi-annual buyers show better metrics than other frequencies</p></li>
</ul>
</li>
</ul>
<p><strong>By Time to Next Purchase Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;repeat_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">,</span> <span class="s1">&#39;Non-Repeating&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;repeat_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_37a6e caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_37a6e th {
  border: 1px solid black;
}
#T_37a6e_row0_col0, #T_37a6e_row0_col2 {
  background-color: rgb(245,250,243);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row0_col1, #T_37a6e_row1_col3, #T_37a6e_row2_col2, #T_37a6e_row3_col3, #T_37a6e_row4_col2, #T_37a6e_row5_col0, #T_37a6e_row5_col1, #T_37a6e_row5_col2, #T_37a6e_row6_col0, #T_37a6e_row6_col1, #T_37a6e_row6_col2, #T_37a6e_row6_col3, #T_37a6e_row7_col0, #T_37a6e_row7_col1, #T_37a6e_row7_col2, #T_37a6e_row7_col3, #T_37a6e_row8_col0, #T_37a6e_row8_col1, #T_37a6e_row8_col2, #T_37a6e_row8_col3, #T_37a6e_row9_col2, #T_37a6e_row10_col3 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row0_col3, #T_37a6e_row1_col0, #T_37a6e_row2_col0, #T_37a6e_row3_col0, #T_37a6e_row3_col1, #T_37a6e_row3_col2, #T_37a6e_row4_col0, #T_37a6e_row5_col3, #T_37a6e_row9_col1, #T_37a6e_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row1_col1 {
  background-color: rgb(4,71,31);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row1_col2 {
  background-color: rgb(58,111,78);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row2_col1 {
  background-color: rgb(12,77,37);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row2_col3 {
  background-color: rgb(180,202,185);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row4_col1 {
  background-color: rgb(196,214,200);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row4_col3 {
  background-color: white;
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row9_col0 {
  background-color: rgb(187,207,192);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row9_col3 {
  background-color: rgb(76,125,94);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row10_col1 {
  background-color: rgb(36,95,59);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_37a6e_row10_col2 {
  background-color: rgb(18,81,43);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_37a6e">
  <caption>Segment Analysis for Repeat Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >repeat_segment</th>
      <th id="T_37a6e_level0_col0" class="col_heading level0 col0" >Slow Repeat</th>
      <th id="T_37a6e_level0_col1" class="col_heading level0 col1" >Medium Repeat</th>
      <th id="T_37a6e_level0_col2" class="col_heading level0 col2" >Fast Repeat</th>
      <th id="T_37a6e_level0_col3" class="col_heading level0 col3" >Non-Repeating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_37a6e_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_37a6e_row0_col0" class="data row0 col0" >1.13%</td>
      <td id="T_37a6e_row0_col1" class="data row0 col1" >0.56%</td>
      <td id="T_37a6e_row0_col2" class="data row0 col2" >1.22%</td>
      <td id="T_37a6e_row0_col3" class="data row0 col3" >94.43%</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_37a6e_row1_col0" class="data row1 col0" >239.16</td>
      <td id="T_37a6e_row1_col1" class="data row1 col1" >236.61</td>
      <td id="T_37a6e_row1_col2" class="data row1 col2" >207.61</td>
      <td id="T_37a6e_row1_col3" class="data row1 col3" >105.40</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_37a6e_row2_col0" class="data row2 col0" >116.12</td>
      <td id="T_37a6e_row2_col1" class="data row2 col1" >115.39</td>
      <td id="T_37a6e_row2_col2" class="data row2 col2" >101.41</td>
      <td id="T_37a6e_row2_col3" class="data row2 col3" >105.40</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_37a6e_row3_col0" class="data row3 col0" >2.00</td>
      <td id="T_37a6e_row3_col1" class="data row3 col1" >2.00</td>
      <td id="T_37a6e_row3_col2" class="data row3 col2" >2.00</td>
      <td id="T_37a6e_row3_col3" class="data row3 col3" >1.00</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_37a6e_row4_col0" class="data row4 col0" >167.92</td>
      <td id="T_37a6e_row4_col1" class="data row4 col1" >34.01</td>
      <td id="T_37a6e_row4_col2" class="data row4 col2" >0.00</td>
      <td id="T_37a6e_row4_col3" class="data row4 col3" >NaN</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_37a6e_row5_col0" class="data row5 col0" >4.50</td>
      <td id="T_37a6e_row5_col1" class="data row5 col1" >4.50</td>
      <td id="T_37a6e_row5_col2" class="data row5 col2" >4.50</td>
      <td id="T_37a6e_row5_col3" class="data row5 col3" >5.00</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_37a6e_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_37a6e_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_37a6e_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_37a6e_row6_col3" class="data row6 col3" >0.00</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_37a6e_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_37a6e_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_37a6e_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_37a6e_row7_col3" class="data row7 col3" >0.00</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_37a6e_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_37a6e_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_37a6e_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_37a6e_row8_col3" class="data row8 col3" >1.00</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_37a6e_row9_col0" class="data row9 col0" >-11.83</td>
      <td id="T_37a6e_row9_col1" class="data row9 col1" >-11.39</td>
      <td id="T_37a6e_row9_col2" class="data row9 col2" >-11.97</td>
      <td id="T_37a6e_row9_col3" class="data row9 col3" >-11.57</td>
    </tr>
    <tr>
      <th id="T_37a6e_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_37a6e_row10_col0" class="data row10 col0" >1.02</td>
      <td id="T_37a6e_row10_col1" class="data row10 col1" >0.98</td>
      <td id="T_37a6e_row10_col2" class="data row10 col2" >1.00</td>
      <td id="T_37a6e_row10_col3" class="data row10 col3" >0.75</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/fd852ebbb624f0f73215b3b1fdcd39611c29b74ff283f3bf0c99264507724aef.jpg" src="../../_images/fd852ebbb624f0f73215b3b1fdcd39611c29b74ff283f3bf0c99264507724aef.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Among repeat buyers, medium repurchase time segment is smallest (&lt;1%)</p></li>
<li><p>Fast repurchase segment shows worse metrics than medium/slow segments</p></li>
</ul>
<p><strong>By Loyalty Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;loyalty_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;loyalty_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_70713 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_70713 th {
  border: 1px solid black;
}
#T_70713_row0_col0 {
  background-color: rgb(163,189,171);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row0_col1, #T_70713_row1_col2, #T_70713_row2_col0, #T_70713_row3_col0, #T_70713_row3_col1, #T_70713_row3_col2, #T_70713_row4_col1, #T_70713_row5_col1, #T_70713_row6_col0, #T_70713_row6_col1, #T_70713_row6_col2, #T_70713_row7_col0, #T_70713_row7_col1, #T_70713_row7_col2, #T_70713_row8_col0, #T_70713_row8_col1, #T_70713_row8_col2, #T_70713_row9_col2, #T_70713_row10_col2 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row0_col2, #T_70713_row1_col1, #T_70713_row2_col1, #T_70713_row4_col0, #T_70713_row5_col2, #T_70713_row9_col1, #T_70713_row10_col1 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row1_col0 {
  background-color: rgb(230,239,230);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row2_col2 {
  background-color: rgb(245,250,243);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row4_col2 {
  background-color: rgb(80,128,98);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row5_col0 {
  background-color: rgb(61,114,81);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row9_col0 {
  background-color: rgb(196,214,200);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_70713_row10_col0 {
  background-color: rgb(185,205,190);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_70713">
  <caption>Segment Analysis for Loyalty Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >loyalty_segment</th>
      <th id="T_70713_level0_col0" class="col_heading level0 col0" >Neutral</th>
      <th id="T_70713_level0_col1" class="col_heading level0 col1" >Critic</th>
      <th id="T_70713_level0_col2" class="col_heading level0 col2" >Promoter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_70713_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_70713_row0_col0" class="data row0 col0" >27.70%</td>
      <td id="T_70713_row0_col1" class="data row0 col1" >12.86%</td>
      <td id="T_70713_row0_col2" class="data row0 col2" >56.79%</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_70713_row1_col0" class="data row1 col0" >106.77</td>
      <td id="T_70713_row1_col1" class="data row1 col1" >121.09</td>
      <td id="T_70713_row1_col2" class="data row1 col2" >105.74</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_70713_row2_col0" class="data row2 col0" >103.55</td>
      <td id="T_70713_row2_col1" class="data row2 col1" >118.84</td>
      <td id="T_70713_row2_col2" class="data row2 col2" >103.65</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_70713_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_70713_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_70713_row3_col2" class="data row3 col2" >1.00</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_70713_row4_col0" class="data row4 col0" >48.09</td>
      <td id="T_70713_row4_col1" class="data row4 col1" >1.92</td>
      <td id="T_70713_row4_col2" class="data row4 col2" >33.00</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_70713_row5_col0" class="data row5 col0" >4.00</td>
      <td id="T_70713_row5_col1" class="data row5 col1" >1.00</td>
      <td id="T_70713_row5_col2" class="data row5 col2" >5.00</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_70713_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_70713_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_70713_row6_col2" class="data row6 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_70713_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_70713_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_70713_row7_col2" class="data row7 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_70713_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_70713_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_70713_row8_col2" class="data row8 col2" >1.00</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_70713_row9_col0" class="data row9 col0" >-11.26</td>
      <td id="T_70713_row9_col1" class="data row9 col1" >-7.21</td>
      <td id="T_70713_row9_col2" class="data row9 col2" >-12.31</td>
    </tr>
    <tr>
      <th id="T_70713_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_70713_row10_col0" class="data row10 col0" >0.75</td>
      <td id="T_70713_row10_col1" class="data row10 col1" >0.90</td>
      <td id="T_70713_row10_col2" class="data row10 col2" >0.70</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/9fdadf5e18a384dccd7a10e7973300f8ac0119de792b84af1a1339f49f9ea7c2.jpg" src="../../_images/9fdadf5e18a384dccd7a10e7973300f8ac0119de792b84af1a1339f49f9ea7c2.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Loyalty segments:</p>
<ul>
<li><p>Promoters: 58%</p></li>
<li><p>Critics: 13% (lowest)</p></li>
</ul>
</li>
<li><p>Critics have:</p>
<ul>
<li><p>Higher total payment and AOV than promoters/neutrals</p></li>
<li><p>Shortest time between first/last purchase (rarely return)</p></li>
<li><p>Heavier average orders</p></li>
<li><p>Worst median delivery time performance</p></li>
</ul>
</li>
</ul>
<p><strong>By Risk Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;risk_segment&#39;</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;risk_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_f06ac caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_f06ac th {
  border: 1px solid black;
}
#T_f06ac_row0_col0, #T_f06ac_row1_col1, #T_f06ac_row2_col1, #T_f06ac_row3_col0, #T_f06ac_row3_col1, #T_f06ac_row4_col0, #T_f06ac_row5_col0, #T_f06ac_row6_col1, #T_f06ac_row7_col0, #T_f06ac_row7_col1, #T_f06ac_row8_col0, #T_f06ac_row8_col1, #T_f06ac_row9_col1, #T_f06ac_row10_col1 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_f06ac_row0_col1, #T_f06ac_row1_col0, #T_f06ac_row2_col0, #T_f06ac_row4_col1, #T_f06ac_row5_col1, #T_f06ac_row6_col0, #T_f06ac_row9_col0, #T_f06ac_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_f06ac">
  <caption>Segment Analysis for Risk Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >risk_segment</th>
      <th id="T_f06ac_level0_col0" class="col_heading level0 col0" >Risky</th>
      <th id="T_f06ac_level0_col1" class="col_heading level0 col1" >Reliable</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_f06ac_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_f06ac_row0_col0" class="data row0 col0" >0.60%</td>
      <td id="T_f06ac_row0_col1" class="data row0 col1" >99.40%</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_f06ac_row1_col0" class="data row1 col0" >145.72</td>
      <td id="T_f06ac_row1_col1" class="data row1 col1" >107.78</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_f06ac_row2_col0" class="data row2 col0" >119.97</td>
      <td id="T_f06ac_row2_col1" class="data row2 col1" >105.63</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_f06ac_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_f06ac_row3_col1" class="data row3 col1" >1.00</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_f06ac_row4_col0" class="data row4 col0" >7.79</td>
      <td id="T_f06ac_row4_col1" class="data row4 col1" >34.92</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_f06ac_row5_col0" class="data row5 col0" >4.00</td>
      <td id="T_f06ac_row5_col1" class="data row5 col1" >5.00</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_f06ac_row6_col0" class="data row6 col0" >1.00</td>
      <td id="T_f06ac_row6_col1" class="data row6 col1" >0.00</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_f06ac_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_f06ac_row7_col1" class="data row7 col1" >0.00</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_f06ac_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_f06ac_row8_col1" class="data row8 col1" >1.00</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_f06ac_row9_col0" class="data row9 col0" >-10.83</td>
      <td id="T_f06ac_row9_col1" class="data row9 col1" >-11.61</td>
    </tr>
    <tr>
      <th id="T_f06ac_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_f06ac_row10_col0" class="data row10 col0" >1.34</td>
      <td id="T_f06ac_row10_col1" class="data row10 col1" >0.75</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/446453b3d51db65f876215b30012c2047a20049e8ffbf9b68ff95ebb0cdb1008.jpg" src="../../_images/446453b3d51db65f876215b30012c2047a20049e8ffbf9b68ff95ebb0cdb1008.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>99.5% of customers are “Reliable” (no order cancellations)</p></li>
<li><p>Cancellation segment has:</p>
<ul>
<li><p>Much shorter time between first/second purchase</p></li>
<li><p>Higher median total spend and AOV</p></li>
</ul>
</li>
</ul>
<p><strong>By Day of the Week Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;weekday_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;weekday_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_e0033 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_e0033 th {
  border: 1px solid black;
}
#T_e0033_row0_col0, #T_e0033_row1_col1, #T_e0033_row2_col1, #T_e0033_row3_col0, #T_e0033_row3_col1, #T_e0033_row4_col1, #T_e0033_row5_col0, #T_e0033_row5_col1, #T_e0033_row6_col0, #T_e0033_row6_col1, #T_e0033_row7_col1, #T_e0033_row8_col0, #T_e0033_row8_col1, #T_e0033_row9_col0, #T_e0033_row10_col1 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_e0033_row0_col1, #T_e0033_row1_col0, #T_e0033_row2_col0, #T_e0033_row4_col0, #T_e0033_row7_col0, #T_e0033_row9_col1, #T_e0033_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_e0033">
  <caption>Segment Analysis for Weekday Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >weekday_segment</th>
      <th id="T_e0033_level0_col0" class="col_heading level0 col0" >Weekend</th>
      <th id="T_e0033_level0_col1" class="col_heading level0 col1" >Weekday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e0033_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_e0033_row0_col0" class="data row0 col0" >22.74%</td>
      <td id="T_e0033_row0_col1" class="data row0 col1" >74.61%</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_e0033_row1_col0" class="data row1 col0" >109.66</td>
      <td id="T_e0033_row1_col1" class="data row1 col1" >107.28</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_e0033_row2_col0" class="data row2 col0" >106.29</td>
      <td id="T_e0033_row2_col1" class="data row2 col1" >105.38</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_e0033_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_e0033_row3_col1" class="data row3 col1" >1.00</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_e0033_row4_col0" class="data row4 col0" >51.33</td>
      <td id="T_e0033_row4_col1" class="data row4 col1" >25.32</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_e0033_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_e0033_row5_col1" class="data row5 col1" >5.00</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_e0033_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_e0033_row6_col1" class="data row6 col1" >0.00</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_e0033_row7_col0" class="data row7 col0" >1.00</td>
      <td id="T_e0033_row7_col1" class="data row7 col1" >0.00</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_e0033_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_e0033_row8_col1" class="data row8 col1" >1.00</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_e0033_row9_col0" class="data row9 col0" >-12.26</td>
      <td id="T_e0033_row9_col1" class="data row9 col1" >-11.35</td>
    </tr>
    <tr>
      <th id="T_e0033_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_e0033_row10_col0" class="data row10 col0" >0.79</td>
      <td id="T_e0033_row10_col1" class="data row10 col1" >0.75</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/e65a83ea4dbe3811091c2a8c48fdd72a1190a86035b61c088a289d137577f936.jpg" src="../../_images/e65a83ea4dbe3811091c2a8c48fdd72a1190a86035b61c088a289d137577f936.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>75% of customers only purchased on weekdays</p></li>
<li><p>Weekend purchasers have significantly longer time between first/last purchase</p></li>
</ul>
<p><strong>By Installment Payment Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;installment_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;installment_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_d3a4b caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_d3a4b th {
  border: 1px solid black;
}
#T_d3a4b_row0_col0, #T_d3a4b_row1_col0, #T_d3a4b_row2_col0, #T_d3a4b_row4_col0, #T_d3a4b_row9_col1, #T_d3a4b_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_d3a4b_row0_col1, #T_d3a4b_row1_col1, #T_d3a4b_row2_col1, #T_d3a4b_row3_col0, #T_d3a4b_row3_col1, #T_d3a4b_row4_col1, #T_d3a4b_row5_col0, #T_d3a4b_row5_col1, #T_d3a4b_row6_col0, #T_d3a4b_row6_col1, #T_d3a4b_row7_col0, #T_d3a4b_row7_col1, #T_d3a4b_row8_col0, #T_d3a4b_row8_col1, #T_d3a4b_row9_col0, #T_d3a4b_row10_col1 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_d3a4b">
  <caption>Segment Analysis for Installment Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >installment_segment</th>
      <th id="T_d3a4b_level0_col0" class="col_heading level0 col0" >Installment</th>
      <th id="T_d3a4b_level0_col1" class="col_heading level0 col1" >Full Pay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d3a4b_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_d3a4b_row0_col0" class="data row0 col0" >50.25%</td>
      <td id="T_d3a4b_row0_col1" class="data row0 col1" >47.10%</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_d3a4b_row1_col0" class="data row1 col0" >138.60</td>
      <td id="T_d3a4b_row1_col1" class="data row1 col1" >80.88</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_d3a4b_row2_col0" class="data row2 col0" >135.08</td>
      <td id="T_d3a4b_row2_col1" class="data row2 col1" >79.28</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_d3a4b_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_d3a4b_row3_col1" class="data row3 col1" >1.00</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_d3a4b_row4_col0" class="data row4 col0" >43.21</td>
      <td id="T_d3a4b_row4_col1" class="data row4 col1" >23.21</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_d3a4b_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_d3a4b_row5_col1" class="data row5 col1" >5.00</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_d3a4b_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_d3a4b_row6_col1" class="data row6 col1" >0.00</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_d3a4b_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_d3a4b_row7_col1" class="data row7 col1" >0.00</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_d3a4b_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_d3a4b_row8_col1" class="data row8 col1" >1.00</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_d3a4b_row9_col0" class="data row9 col0" >-12.18</td>
      <td id="T_d3a4b_row9_col1" class="data row9 col1" >-11.21</td>
    </tr>
    <tr>
      <th id="T_d3a4b_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_d3a4b_row10_col0" class="data row10 col0" >1.00</td>
      <td id="T_d3a4b_row10_col1" class="data row10 col1" >0.55</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/2e491a42dbfafe600b9e22a595ec653aba5fcc7d8cd3f2d6afee734b21fe94f4.jpg" src="../../_images/2e491a42dbfafe600b9e22a595ec653aba5fcc7d8cd3f2d6afee734b21fe94f4.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>50% used installments at least once</p></li>
<li><p>47% always paid in full</p></li>
<li><p>Installment users have significantly higher:</p>
<ul>
<li><p>Median total spend</p></li>
<li><p>AOV</p></li>
<li><p>Order weight</p></li>
<li><p>Time between first/last purchase</p></li>
</ul>
</li>
</ul>
<p><strong>By Average Number of Products per Order Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;products_cnt_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;products_cnt_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_80992 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_80992 th {
  border: 1px solid black;
}
#T_80992_row0_col0, #T_80992_row1_col1, #T_80992_row2_col1, #T_80992_row3_col0, #T_80992_row3_col1, #T_80992_row3_col2, #T_80992_row4_col2, #T_80992_row5_col0, #T_80992_row5_col2, #T_80992_row6_col0, #T_80992_row6_col1, #T_80992_row6_col2, #T_80992_row7_col0, #T_80992_row7_col1, #T_80992_row7_col2, #T_80992_row8_col1, #T_80992_row9_col0, #T_80992_row10_col1 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row0_col1, #T_80992_row1_col0, #T_80992_row2_col0, #T_80992_row4_col0, #T_80992_row5_col1, #T_80992_row8_col0, #T_80992_row9_col1, #T_80992_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row0_col2 {
  background-color: rgb(231,240,230);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row1_col2 {
  background-color: rgb(146,177,156);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row2_col2 {
  background-color: rgb(151,180,160);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row4_col1 {
  background-color: rgb(214,227,216);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row8_col2 {
  background-color: rgb(123,160,136);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row9_col2 {
  background-color: rgb(225,236,226);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_80992_row10_col2 {
  background-color: rgb(160,187,168);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_80992">
  <caption>Segment Analysis for Products Cnt Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >products_cnt_segment</th>
      <th id="T_80992_level0_col0" class="col_heading level0 col0" >Bulk Buyer</th>
      <th id="T_80992_level0_col1" class="col_heading level0 col1" >Single Product</th>
      <th id="T_80992_level0_col2" class="col_heading level0 col2" >Multi Product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_80992_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_80992_row0_col0" class="data row0 col0" >2.18%</td>
      <td id="T_80992_row0_col1" class="data row0 col1" >87.47%</td>
      <td id="T_80992_row0_col2" class="data row0 col2" >7.70%</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_80992_row1_col0" class="data row1 col0" >251.54</td>
      <td id="T_80992_row1_col1" class="data row1 col1" >101.37</td>
      <td id="T_80992_row1_col2" class="data row1 col2" >162.45</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_80992_row2_col0" class="data row2 col0" >241.43</td>
      <td id="T_80992_row2_col1" class="data row2 col1" >99.40</td>
      <td id="T_80992_row2_col2" class="data row2 col2" >154.31</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_80992_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_80992_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_80992_row3_col2" class="data row3 col2" >1.00</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_80992_row4_col0" class="data row4 col0" >48.88</td>
      <td id="T_80992_row4_col1" class="data row4 col1" >35.06</td>
      <td id="T_80992_row4_col2" class="data row4 col2" >32.98</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_80992_row5_col0" class="data row5 col0" >4.00</td>
      <td id="T_80992_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_80992_row5_col2" class="data row5 col2" >4.00</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_80992_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_80992_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_80992_row6_col2" class="data row6 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_80992_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_80992_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_80992_row7_col2" class="data row7 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_80992_row8_col0" class="data row8 col0" >3.00</td>
      <td id="T_80992_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_80992_row8_col2" class="data row8 col2" >2.00</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_80992_row9_col0" class="data row9 col0" >-12.37</td>
      <td id="T_80992_row9_col1" class="data row9 col1" >-11.45</td>
      <td id="T_80992_row9_col2" class="data row9 col2" >-12.29</td>
    </tr>
    <tr>
      <th id="T_80992_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_80992_row10_col0" class="data row10 col0" >2.85</td>
      <td id="T_80992_row10_col1" class="data row10 col1" >0.70</td>
      <td id="T_80992_row10_col2" class="data row10 col2" >1.45</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/e7583381862a149e478495b01d51c3662a74c6f92f51c0f891041dd49e59bebb.jpg" src="../../_images/e7583381862a149e478495b01d51c3662a74c6f92f51c0f891041dd49e59bebb.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>88% of customers had ≤1 product per order</p></li>
<li><p>8% averaged 1-2 products</p></li>
<li><p>Only 2% averaged &gt;2 products</p></li>
<li><p>Customers with 2+ products per order have significantly higher:</p>
<ul>
<li><p>Median order weight</p></li>
<li><p>Total spend</p></li>
<li><p>AOV</p></li>
<li><p>Time between first/last purchase</p></li>
</ul>
</li>
</ul>
<p><strong>By Average Weight of Order Segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;weight_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;weight_segment&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_68d7b caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_68d7b th {
  border: 1px solid black;
}
#T_68d7b_row0_col0, #T_68d7b_row1_col1, #T_68d7b_row2_col1, #T_68d7b_row3_col0, #T_68d7b_row3_col1, #T_68d7b_row3_col2, #T_68d7b_row4_col1, #T_68d7b_row5_col0, #T_68d7b_row5_col1, #T_68d7b_row5_col2, #T_68d7b_row6_col0, #T_68d7b_row6_col1, #T_68d7b_row6_col2, #T_68d7b_row7_col0, #T_68d7b_row7_col1, #T_68d7b_row7_col2, #T_68d7b_row8_col0, #T_68d7b_row8_col1, #T_68d7b_row8_col2, #T_68d7b_row9_col0, #T_68d7b_row10_col1 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_68d7b_row0_col1, #T_68d7b_row1_col0, #T_68d7b_row2_col0, #T_68d7b_row4_col2, #T_68d7b_row9_col1, #T_68d7b_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_68d7b_row0_col2 {
  background-color: rgb(26,87,50);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_68d7b_row1_col2 {
  background-color: rgb(156,184,165);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_68d7b_row2_col2 {
  background-color: rgb(157,185,166);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_68d7b_row4_col0 {
  background-color: rgb(23,85,47);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_68d7b_row9_col2 {
  background-color: rgb(240,247,239);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_68d7b_row10_col2 {
  background-color: rgb(211,225,213);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_68d7b">
  <caption>Segment Analysis for Weight Segment</caption>
  <thead>
    <tr>
      <th class="index_name level0" >weight_segment</th>
      <th id="T_68d7b_level0_col0" class="col_heading level0 col0" >Heavy</th>
      <th id="T_68d7b_level0_col1" class="col_heading level0 col1" >Light</th>
      <th id="T_68d7b_level0_col2" class="col_heading level0 col2" >Medium</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_68d7b_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_68d7b_row0_col0" class="data row0 col0" >21.30%</td>
      <td id="T_68d7b_row0_col1" class="data row0 col1" >38.98%</td>
      <td id="T_68d7b_row0_col2" class="data row0 col2" >37.07%</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_68d7b_row1_col0" class="data row1 col0" >193.72</td>
      <td id="T_68d7b_row1_col1" class="data row1 col1" >65.53</td>
      <td id="T_68d7b_row1_col2" class="data row1 col2" >112.34</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_68d7b_row2_col0" class="data row2 col0" >189.37</td>
      <td id="T_68d7b_row2_col1" class="data row2 col1" >64.82</td>
      <td id="T_68d7b_row2_col2" class="data row2 col2" >109.86</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_68d7b_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_68d7b_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_68d7b_row3_col2" class="data row3 col2" >1.00</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_68d7b_row4_col0" class="data row4 col0" >38.67</td>
      <td id="T_68d7b_row4_col1" class="data row4 col1" >27.17</td>
      <td id="T_68d7b_row4_col2" class="data row4 col2" >39.88</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_68d7b_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_68d7b_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_68d7b_row5_col2" class="data row5 col2" >5.00</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_68d7b_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_68d7b_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_68d7b_row6_col2" class="data row6 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_68d7b_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_68d7b_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_68d7b_row7_col2" class="data row7 col2" >0.00</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_68d7b_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_68d7b_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_68d7b_row8_col2" class="data row8 col2" >1.00</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_68d7b_row9_col0" class="data row9 col0" >-12.07</td>
      <td id="T_68d7b_row9_col1" class="data row9 col1" >-11.32</td>
      <td id="T_68d7b_row9_col2" class="data row9 col2" >-12.05</td>
    </tr>
    <tr>
      <th id="T_68d7b_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_68d7b_row10_col0" class="data row10 col0" >6.20</td>
      <td id="T_68d7b_row10_col1" class="data row10 col1" >0.25</td>
      <td id="T_68d7b_row10_col2" class="data row10 col2" >1.10</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/c7a1b1522e471d0e1663223014b7969e43b7655c256ec9479426463417f60229.jpg" src="../../_images/c7a1b1522e471d0e1663223014b7969e43b7655c256ec9479426463417f60229.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Order weight segments:</p>
<ul>
<li><p>Light: 39%</p></li>
<li><p>Medium: 37%</p></li>
<li><p>Heavy: 21%</p></li>
</ul>
</li>
<li><p>Heavy segment has significantly higher total spend and AOV</p></li>
<li><p>Light segment has shorter time between first/last purchase</p></li>
</ul>
<p><strong>By Top Days of the Week</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_top_purchase_weekdays&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_top_purchase_weekdays&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_40593 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_40593 th {
  border: 1px solid black;
}
#T_40593_row0_col0, #T_40593_row1_col0, #T_40593_row2_col0, #T_40593_row9_col0, #T_40593_row10_col0, #T_40593_row10_col1, #T_40593_row10_col2, #T_40593_row10_col4 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row0_col1 {
  background-color: rgb(27,88,50);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row0_col2, #T_40593_row1_col3, #T_40593_row1_col4, #T_40593_row2_col3, #T_40593_row3_col0, #T_40593_row3_col1, #T_40593_row3_col2, #T_40593_row3_col3, #T_40593_row3_col4, #T_40593_row4_col0, #T_40593_row4_col1, #T_40593_row4_col2, #T_40593_row4_col3, #T_40593_row4_col4, #T_40593_row5_col0, #T_40593_row5_col1, #T_40593_row5_col2, #T_40593_row5_col3, #T_40593_row5_col4, #T_40593_row6_col0, #T_40593_row6_col1, #T_40593_row6_col2, #T_40593_row6_col3, #T_40593_row6_col4, #T_40593_row7_col0, #T_40593_row7_col1, #T_40593_row7_col2, #T_40593_row7_col3, #T_40593_row7_col4, #T_40593_row8_col0, #T_40593_row8_col1, #T_40593_row8_col2, #T_40593_row8_col3, #T_40593_row8_col4, #T_40593_row9_col4, #T_40593_row10_col3 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row0_col3 {
  background-color: rgb(79,126,96);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row0_col4 {
  background-color: rgb(176,199,182);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row1_col1 {
  background-color: rgb(160,187,168);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row1_col2 {
  background-color: rgb(180,202,186);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row2_col1 {
  background-color: rgb(153,182,162);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row2_col2 {
  background-color: rgb(207,222,210);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row2_col4 {
  background-color: rgb(235,243,234);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row9_col1 {
  background-color: rgb(42,99,64);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row9_col2 {
  background-color: rgb(60,113,80);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_40593_row9_col3 {
  background-color: rgb(134,167,145);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_40593">
  <caption>Segment Analysis for Customer Top Purchase Weekdays</caption>
  <thead>
    <tr>
      <th class="index_name level0" >customer_top_purchase_weekdays</th>
      <th id="T_40593_level0_col0" class="col_heading level0 col0" >Monday</th>
      <th id="T_40593_level0_col1" class="col_heading level0 col1" >Tuesday</th>
      <th id="T_40593_level0_col2" class="col_heading level0 col2" >Friday</th>
      <th id="T_40593_level0_col3" class="col_heading level0 col3" >Wednesday</th>
      <th id="T_40593_level0_col4" class="col_heading level0 col4" >Thursday</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_40593_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_40593_row0_col0" class="data row0 col0" >15.57%</td>
      <td id="T_40593_row0_col1" class="data row0 col1" >15.35%</td>
      <td id="T_40593_row0_col2" class="data row0 col2" >13.57%</td>
      <td id="T_40593_row0_col3" class="data row0 col3" >14.93%</td>
      <td id="T_40593_row0_col4" class="data row0 col4" >14.14%</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_40593_row1_col0" class="data row1 col0" >108.14</td>
      <td id="T_40593_row1_col1" class="data row1 col1" >106.29</td>
      <td id="T_40593_row1_col2" class="data row1 col2" >106.06</td>
      <td id="T_40593_row1_col3" class="data row1 col3" >105.29</td>
      <td id="T_40593_row1_col4" class="data row1 col4" >105.29</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_40593_row2_col0" class="data row2 col0" >107.45</td>
      <td id="T_40593_row2_col1" class="data row2 col1" >105.38</td>
      <td id="T_40593_row2_col2" class="data row2 col2" >104.65</td>
      <td id="T_40593_row2_col3" class="data row2 col3" >104.12</td>
      <td id="T_40593_row2_col4" class="data row2 col4" >104.28</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_40593_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_40593_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_40593_row3_col2" class="data row3 col2" >1.00</td>
      <td id="T_40593_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_40593_row3_col4" class="data row3 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_40593_row4_col0" class="data row4 col0" >0.00</td>
      <td id="T_40593_row4_col1" class="data row4 col1" >0.00</td>
      <td id="T_40593_row4_col2" class="data row4 col2" >0.00</td>
      <td id="T_40593_row4_col3" class="data row4 col3" >0.00</td>
      <td id="T_40593_row4_col4" class="data row4 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_40593_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_40593_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_40593_row5_col2" class="data row5 col2" >5.00</td>
      <td id="T_40593_row5_col3" class="data row5 col3" >5.00</td>
      <td id="T_40593_row5_col4" class="data row5 col4" >5.00</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_40593_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_40593_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_40593_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_40593_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_40593_row6_col4" class="data row6 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_40593_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_40593_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_40593_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_40593_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_40593_row7_col4" class="data row7 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_40593_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_40593_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_40593_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_40593_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_40593_row8_col4" class="data row8 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_40593_row9_col0" class="data row9 col0" >-11.16</td>
      <td id="T_40593_row9_col1" class="data row9 col1" >-11.30</td>
      <td id="T_40593_row9_col2" class="data row9 col2" >-11.36</td>
      <td id="T_40593_row9_col3" class="data row9 col3" >-11.60</td>
      <td id="T_40593_row9_col4" class="data row9 col4" >-11.97</td>
    </tr>
    <tr>
      <th id="T_40593_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_40593_row10_col0" class="data row10 col0" >0.75</td>
      <td id="T_40593_row10_col1" class="data row10 col1" >0.75</td>
      <td id="T_40593_row10_col2" class="data row10 col2" >0.75</td>
      <td id="T_40593_row10_col3" class="data row10 col3" >0.70</td>
      <td id="T_40593_row10_col4" class="data row10 col4" >0.75</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/1dc0e30afcaf3410426a78a633bd7b45135f29a85b578481acc4d686434ee244.jpg" src="../../_images/1dc0e30afcaf3410426a78a633bd7b45135f29a85b578481acc4d686434ee244.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Most customers only purchased on one weekday (expected due to low repeat purchases)</p></li>
<li><p>Top 3 purchase days: Monday, Tuesday, Wednesday</p></li>
<li><p>Monday-only buyers have longer time between first/last purchase than other top segments (possibly coincidental)</p></li>
</ul>
<p><strong>By Top Payment Types</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_payment_types&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
    <span class="p">,</span> <span class="n">text_auto</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_payment_types&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_02178 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_02178 th {
  border: 1px solid black;
}
#T_02178_row0_col0 {
  background-color: rgb(244,249,242);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row0_col1, #T_02178_row1_col1, #T_02178_row2_col1, #T_02178_row4_col0, #T_02178_row9_col3, #T_02178_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row0_col2 {
  background-color: rgb(185,205,190);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row0_col3 {
  background-color: rgb(246,251,244);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row0_col4, #T_02178_row1_col4, #T_02178_row2_col4, #T_02178_row3_col0, #T_02178_row3_col1, #T_02178_row3_col2, #T_02178_row3_col3, #T_02178_row3_col4, #T_02178_row4_col3, #T_02178_row5_col0, #T_02178_row5_col1, #T_02178_row5_col2, #T_02178_row5_col3, #T_02178_row5_col4, #T_02178_row6_col0, #T_02178_row6_col1, #T_02178_row6_col2, #T_02178_row6_col3, #T_02178_row6_col4, #T_02178_row7_col0, #T_02178_row7_col1, #T_02178_row7_col2, #T_02178_row7_col3, #T_02178_row7_col4, #T_02178_row8_col0, #T_02178_row8_col1, #T_02178_row8_col2, #T_02178_row8_col3, #T_02178_row8_col4, #T_02178_row9_col0, #T_02178_row10_col3 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row1_col0 {
  background-color: rgb(32,91,55);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row1_col2 {
  background-color: rgb(103,144,118);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row1_col3 {
  background-color: rgb(135,168,146);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row2_col0 {
  background-color: rgb(45,101,66);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row2_col2 {
  background-color: rgb(101,143,116);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row2_col3 {
  background-color: rgb(126,162,138);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row4_col1 {
  background-color: rgb(149,179,159);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row4_col2 {
  background-color: rgb(196,214,200);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row4_col4 {
  background-color: rgb(232,240,231);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row9_col1 {
  background-color: rgb(226,236,227);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row9_col2 {
  background-color: rgb(84,130,101);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row9_col4 {
  background-color: rgb(124,161,137);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row10_col1 {
  background-color: rgb(41,98,63);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row10_col2 {
  background-color: rgb(123,160,136);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_02178_row10_col4 {
  background-color: rgb(238,245,237);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_02178">
  <caption>Segment Analysis for Customer Payment Types</caption>
  <thead>
    <tr>
      <th class="index_name level0" >customer_payment_types</th>
      <th id="T_02178_level0_col0" class="col_heading level0 col0" >Credit Card, Voucher</th>
      <th id="T_02178_level0_col1" class="col_heading level0 col1" >Credit Card</th>
      <th id="T_02178_level0_col2" class="col_heading level0 col2" >Boleto</th>
      <th id="T_02178_level0_col3" class="col_heading level0 col3" >Debit Card</th>
      <th id="T_02178_level0_col4" class="col_heading level0 col4" >Voucher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_02178_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_02178_row0_col0" class="data row0 col0" >2.26%</td>
      <td id="T_02178_row0_col1" class="data row0 col1" >72.61%</td>
      <td id="T_02178_row0_col2" class="data row0 col2" >19.26%</td>
      <td id="T_02178_row0_col3" class="data row0 col3" >1.49%</td>
      <td id="T_02178_row0_col4" class="data row0 col4" >1.45%</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_02178_row1_col0" class="data row1 col0" >107.25</td>
      <td id="T_02178_row1_col1" class="data row1 col1" >112.64</td>
      <td id="T_02178_row1_col2" class="data row1 col2" >95.30</td>
      <td id="T_02178_row1_col3" class="data row1 col3" >89.88</td>
      <td id="T_02178_row1_col4" class="data row1 col4" >71.14</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_02178_row2_col0" class="data row2 col0" >102.73</td>
      <td id="T_02178_row2_col1" class="data row2 col1" >109.93</td>
      <td id="T_02178_row2_col2" class="data row2 col2" >93.82</td>
      <td id="T_02178_row2_col3" class="data row2 col3" >89.75</td>
      <td id="T_02178_row2_col4" class="data row2 col4" >70.63</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_02178_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_02178_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_02178_row3_col2" class="data row3 col2" >1.00</td>
      <td id="T_02178_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_02178_row3_col4" class="data row3 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_02178_row4_col0" class="data row4 col0" >78.03</td>
      <td id="T_02178_row4_col1" class="data row4 col1" >30.76</td>
      <td id="T_02178_row4_col2" class="data row4 col2" >15.98</td>
      <td id="T_02178_row4_col3" class="data row4 col3" >0.00</td>
      <td id="T_02178_row4_col4" class="data row4 col4" >4.69</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_02178_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_02178_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_02178_row5_col2" class="data row5 col2" >5.00</td>
      <td id="T_02178_row5_col3" class="data row5 col3" >5.00</td>
      <td id="T_02178_row5_col4" class="data row5 col4" >5.00</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_02178_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_02178_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_02178_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_02178_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_02178_row6_col4" class="data row6 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_02178_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_02178_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_02178_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_02178_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_02178_row7_col4" class="data row7 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_02178_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_02178_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_02178_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_02178_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_02178_row8_col4" class="data row8 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_02178_row9_col0" class="data row9 col0" >-12.23</td>
      <td id="T_02178_row9_col1" class="data row9 col1" >-12.08</td>
      <td id="T_02178_row9_col2" class="data row9 col2" >-11.03</td>
      <td id="T_02178_row9_col3" class="data row9 col3" >-10.41</td>
      <td id="T_02178_row9_col4" class="data row9 col4" >-11.33</td>
    </tr>
    <tr>
      <th id="T_02178_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_02178_row10_col0" class="data row10 col0" >0.85</td>
      <td id="T_02178_row10_col1" class="data row10 col1" >0.80</td>
      <td id="T_02178_row10_col2" class="data row10 col2" >0.70</td>
      <td id="T_02178_row10_col3" class="data row10 col3" >0.55</td>
      <td id="T_02178_row10_col4" class="data row10 col4" >0.56</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/1f4b3de3a2110d430658c981c847d84bf5e51d37550a5d29d8e5f7503e28c1e4.jpg" src="../../_images/1f4b3de3a2110d430658c981c847d84bf5e51d37550a5d29d8e5f7503e28c1e4.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Payment methods:</p>
<ul>
<li><p>Credit card only: 73%</p></li>
<li><p>Boleto only: 19%</p></li>
</ul>
</li>
<li><p>Voucher-only segment has lower total spend and AOV than other top payment segments</p></li>
</ul>
<p><strong>By Top Product Categories</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_top_product_categories&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_top_product_categories&#39;</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_62e89 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_62e89 th {
  border: 1px solid black;
}
#T_62e89_row0_col0 {
  background-color: rgb(124,160,136);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row0_col1, #T_62e89_row1_col4, #T_62e89_row2_col4, #T_62e89_row3_col0, #T_62e89_row3_col1, #T_62e89_row3_col2, #T_62e89_row3_col3, #T_62e89_row3_col4, #T_62e89_row4_col4, #T_62e89_row5_col0, #T_62e89_row5_col1, #T_62e89_row5_col2, #T_62e89_row5_col3, #T_62e89_row5_col4, #T_62e89_row6_col0, #T_62e89_row6_col1, #T_62e89_row6_col2, #T_62e89_row6_col3, #T_62e89_row6_col4, #T_62e89_row7_col0, #T_62e89_row7_col1, #T_62e89_row7_col2, #T_62e89_row7_col3, #T_62e89_row7_col4, #T_62e89_row8_col0, #T_62e89_row8_col1, #T_62e89_row8_col2, #T_62e89_row8_col3, #T_62e89_row8_col4, #T_62e89_row9_col4, #T_62e89_row10_col4 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row0_col2, #T_62e89_row1_col0, #T_62e89_row2_col0, #T_62e89_row4_col0, #T_62e89_row9_col2, #T_62e89_row10_col1 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row0_col3 {
  background-color: rgb(22,84,46);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row0_col4 {
  background-color: rgb(197,215,201);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row1_col1 {
  background-color: rgb(205,221,208);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row1_col2 {
  background-color: rgb(187,207,192);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row1_col3 {
  background-color: rgb(211,225,213);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row2_col1 {
  background-color: rgb(223,234,224);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row2_col2 {
  background-color: rgb(180,202,186);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row2_col3 {
  background-color: rgb(212,226,214);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row4_col1 {
  background-color: rgb(246,251,244);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row4_col2 {
  background-color: rgb(238,245,237);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row4_col3 {
  background-color: rgb(120,158,133);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row9_col0 {
  background-color: rgb(143,174,153);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row9_col1 {
  background-color: rgb(37,95,59);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row9_col3 {
  background-color: rgb(177,200,183);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row10_col0 {
  background-color: rgb(170,194,177);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row10_col2 {
  background-color: rgb(71,121,90);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_62e89_row10_col3 {
  background-color: rgb(228,238,228);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_62e89">
  <caption>Segment Analysis for Customer Top Product Categories</caption>
  <thead>
    <tr>
      <th class="index_name level0" >customer_top_product_categories</th>
      <th id="T_62e89_level0_col0" class="col_heading level0 col0" >Sports Leisure</th>
      <th id="T_62e89_level0_col1" class="col_heading level0 col1" >Furniture Decor</th>
      <th id="T_62e89_level0_col2" class="col_heading level0 col2" >Bed Bath Table</th>
      <th id="T_62e89_level0_col3" class="col_heading level0 col3" >Health Beauty</th>
      <th id="T_62e89_level0_col4" class="col_heading level0 col4" >Computers Accessories</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_62e89_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_62e89_row0_col0" class="data row0 col0" >7.35%</td>
      <td id="T_62e89_row0_col1" class="data row0 col1" >5.88%</td>
      <td id="T_62e89_row0_col2" class="data row0 col2" >8.84%</td>
      <td id="T_62e89_row0_col3" class="data row0 col3" >8.57%</td>
      <td id="T_62e89_row0_col4" class="data row0 col4" >6.47%</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_62e89_row1_col0" class="data row1 col0" >112.43</td>
      <td id="T_62e89_row1_col1" class="data row1 col1" >105.56</td>
      <td id="T_62e89_row1_col2" class="data row1 col2" >106.16</td>
      <td id="T_62e89_row1_col3" class="data row1 col3" >105.37</td>
      <td id="T_62e89_row1_col4" class="data row1 col4" >104.18</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_62e89_row2_col0" class="data row2 col0" >111.02</td>
      <td id="T_62e89_row2_col1" class="data row2 col1" >103.90</td>
      <td id="T_62e89_row2_col2" class="data row2 col2" >105.28</td>
      <td id="T_62e89_row2_col3" class="data row2 col3" >104.26</td>
      <td id="T_62e89_row2_col4" class="data row2 col4" >103.16</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_62e89_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_62e89_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_62e89_row3_col2" class="data row3 col2" >1.00</td>
      <td id="T_62e89_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_62e89_row3_col4" class="data row3 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_62e89_row4_col0" class="data row4 col0" >26.99</td>
      <td id="T_62e89_row4_col1" class="data row4 col1" >0.02</td>
      <td id="T_62e89_row4_col2" class="data row4 col2" >0.96</td>
      <td id="T_62e89_row4_col3" class="data row4 col3" >13.78</td>
      <td id="T_62e89_row4_col4" class="data row4 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_62e89_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_62e89_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_62e89_row5_col2" class="data row5 col2" >5.00</td>
      <td id="T_62e89_row5_col3" class="data row5 col3" >5.00</td>
      <td id="T_62e89_row5_col4" class="data row5 col4" >5.00</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_62e89_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_62e89_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_62e89_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_62e89_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_62e89_row6_col4" class="data row6 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_62e89_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_62e89_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_62e89_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_62e89_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_62e89_row7_col4" class="data row7 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_62e89_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_62e89_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_62e89_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_62e89_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_62e89_row8_col4" class="data row8 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_62e89_row9_col0" class="data row9 col0" >-11.82</td>
      <td id="T_62e89_row9_col1" class="data row9 col1" >-11.39</td>
      <td id="T_62e89_row9_col2" class="data row9 col2" >-11.24</td>
      <td id="T_62e89_row9_col3" class="data row9 col3" >-11.96</td>
      <td id="T_62e89_row9_col4" class="data row9 col4" >-12.24</td>
    </tr>
    <tr>
      <th id="T_62e89_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_62e89_row10_col0" class="data row10 col0" >0.80</td>
      <td id="T_62e89_row10_col1" class="data row10 col1" >1.80</td>
      <td id="T_62e89_row10_col2" class="data row10 col2" >1.38</td>
      <td id="T_62e89_row10_col3" class="data row10 col3" >0.46</td>
      <td id="T_62e89_row10_col4" class="data row10 col4" >0.35</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/670e02fcf68ba7cc6da5639f4bb22956f5683622ca9b630683d9e1ce481126b7.jpg" src="../../_images/670e02fcf68ba7cc6da5639f4bb22956f5683622ca9b630683d9e1ce481126b7.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Most customers only bought from:</p>
<ul>
<li><p>Bed Bath Table</p></li>
<li><p>Health Beauty categories</p></li>
</ul>
</li>
<li><p>Sports goods buyers have longer time between first/last purchase than other category segments</p></li>
</ul>
<p><strong>By Top General Product Categories</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_top_general_product_categories&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_top_general_product_categories&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_3755c caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_3755c th {
  border: 1px solid black;
}
#T_3755c_row0_col0 {
  background-color: rgb(147,178,157);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row0_col1, #T_3755c_row1_col0, #T_3755c_row2_col0, #T_3755c_row4_col2, #T_3755c_row9_col0, #T_3755c_row10_col0 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row0_col2, #T_3755c_row1_col1, #T_3755c_row2_col1, #T_3755c_row3_col0, #T_3755c_row3_col1, #T_3755c_row3_col2, #T_3755c_row3_col3, #T_3755c_row3_col4, #T_3755c_row4_col0, #T_3755c_row5_col0, #T_3755c_row5_col1, #T_3755c_row5_col2, #T_3755c_row5_col3, #T_3755c_row5_col4, #T_3755c_row6_col0, #T_3755c_row6_col1, #T_3755c_row6_col2, #T_3755c_row6_col3, #T_3755c_row6_col4, #T_3755c_row7_col0, #T_3755c_row7_col1, #T_3755c_row7_col2, #T_3755c_row7_col3, #T_3755c_row7_col4, #T_3755c_row8_col0, #T_3755c_row8_col1, #T_3755c_row8_col2, #T_3755c_row8_col3, #T_3755c_row8_col4, #T_3755c_row9_col4, #T_3755c_row10_col1 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row0_col3 {
  background-color: rgb(210,224,212);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row0_col4 {
  background-color: rgb(246,251,244);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row1_col2 {
  background-color: rgb(106,147,120);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row1_col3, #T_3755c_row2_col3 {
  background-color: rgb(166,192,174);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row1_col4 {
  background-color: rgb(130,165,142);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row2_col2 {
  background-color: rgb(96,139,112);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row2_col4 {
  background-color: rgb(120,157,132);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row4_col1 {
  background-color: rgb(42,99,64);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row4_col3 {
  background-color: rgb(162,188,170);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row4_col4 {
  background-color: rgb(82,129,100);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row9_col1 {
  background-color: rgb(60,113,80);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row9_col2 {
  background-color: rgb(240,246,239);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row9_col3 {
  background-color: rgb(226,236,227);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row10_col2 {
  background-color: rgb(163,189,171);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row10_col3 {
  background-color: rgb(27,88,51);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_3755c_row10_col4 {
  background-color: rgb(230,239,230);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_3755c">
  <caption>Segment Analysis for Customer Top General Product Categories</caption>
  <thead>
    <tr>
      <th class="index_name level0" >customer_top_general_product_categories</th>
      <th id="T_3755c_level0_col0" class="col_heading level0 col0" >Furniture</th>
      <th id="T_3755c_level0_col1" class="col_heading level0 col1" >Electronics</th>
      <th id="T_3755c_level0_col2" class="col_heading level0 col2" >Entertainment</th>
      <th id="T_3755c_level0_col3" class="col_heading level0 col3" >Home & Garden</th>
      <th id="T_3755c_level0_col4" class="col_heading level0 col4" >Beauty & Health</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_3755c_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_3755c_row0_col0" class="data row0 col0" >17.38%</td>
      <td id="T_3755c_row0_col1" class="data row0 col1" >25.99%</td>
      <td id="T_3755c_row0_col2" class="data row0 col2" >11.62%</td>
      <td id="T_3755c_row0_col3" class="data row0 col3" >13.73%</td>
      <td id="T_3755c_row0_col4" class="data row0 col4" >11.65%</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_3755c_row1_col0" class="data row1 col0" >115.81</td>
      <td id="T_3755c_row1_col1" class="data row1 col1" >97.62</td>
      <td id="T_3755c_row1_col2" class="data row1 col2" >107.98</td>
      <td id="T_3755c_row1_col3" class="data row1 col3" >103.53</td>
      <td id="T_3755c_row1_col4" class="data row1 col4" >106.19</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_3755c_row2_col0" class="data row2 col0" >113.62</td>
      <td id="T_3755c_row2_col1" class="data row2 col1" >96.65</td>
      <td id="T_3755c_row2_col2" class="data row2 col2" >107.00</td>
      <td id="T_3755c_row2_col3" class="data row2 col3" >102.16</td>
      <td id="T_3755c_row2_col4" class="data row2 col4" >105.37</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_3755c_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_3755c_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_3755c_row3_col2" class="data row3 col2" >1.00</td>
      <td id="T_3755c_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_3755c_row3_col4" class="data row3 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_3755c_row4_col0" class="data row4 col0" >1.32</td>
      <td id="T_3755c_row4_col1" class="data row4 col1" >20.82</td>
      <td id="T_3755c_row4_col2" class="data row4 col2" >24.83</td>
      <td id="T_3755c_row4_col3" class="data row4 col3" >9.38</td>
      <td id="T_3755c_row4_col4" class="data row4 col4" >16.93</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_3755c_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_3755c_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_3755c_row5_col2" class="data row5 col2" >5.00</td>
      <td id="T_3755c_row5_col3" class="data row5 col3" >5.00</td>
      <td id="T_3755c_row5_col4" class="data row5 col4" >5.00</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_3755c_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_3755c_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_3755c_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_3755c_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_3755c_row6_col4" class="data row6 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_3755c_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_3755c_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_3755c_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_3755c_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_3755c_row7_col4" class="data row7 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_3755c_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_3755c_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_3755c_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_3755c_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_3755c_row8_col4" class="data row8 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_3755c_row9_col0" class="data row9 col0" >-11.31</td>
      <td id="T_3755c_row9_col1" class="data row9 col1" >-11.49</td>
      <td id="T_3755c_row9_col2" class="data row9 col2" >-12.02</td>
      <td id="T_3755c_row9_col3" class="data row9 col3" >-11.98</td>
      <td id="T_3755c_row9_col4" class="data row9 col4" >-12.04</td>
    </tr>
    <tr>
      <th id="T_3755c_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_3755c_row10_col0" class="data row10 col0" >1.70</td>
      <td id="T_3755c_row10_col1" class="data row10 col1" >0.34</td>
      <td id="T_3755c_row10_col2" class="data row10 col2" >0.80</td>
      <td id="T_3755c_row10_col3" class="data row10 col3" >1.55</td>
      <td id="T_3755c_row10_col4" class="data row10 col4" >0.43</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/d46af384b5940eed9996ba1fe7e9a2265a81e0bc3d46a7a5585c550cd92186ab.jpg" src="../../_images/d46af384b5940eed9996ba1fe7e9a2265a81e0bc3d46a7a5585c550cd92186ab.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Top generalized category segments:</p>
<ul>
<li><p>Electronics only: 26%</p></li>
<li><p>Furniture only: 17%</p></li>
<li><p>Home &amp; Garden only: 14%</p></li>
</ul>
</li>
</ul>
<p><strong>By Customer State</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_state&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_state&#39;</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_775ec caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_775ec th {
  border: 1px solid black;
}
#T_775ec_row0_col0 {
  background-color: rgb(194,213,198);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row0_col1, #T_775ec_row1_col0, #T_775ec_row2_col0, #T_775ec_row4_col2, #T_775ec_row9_col1, #T_775ec_row10_col2 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row0_col2 {
  background-color: rgb(244,250,242);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row0_col3 {
  background-color: rgb(202,218,205);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row0_col4, #T_775ec_row1_col1, #T_775ec_row2_col1, #T_775ec_row3_col0, #T_775ec_row3_col1, #T_775ec_row3_col2, #T_775ec_row3_col3, #T_775ec_row3_col4, #T_775ec_row4_col4, #T_775ec_row5_col0, #T_775ec_row5_col1, #T_775ec_row5_col2, #T_775ec_row5_col3, #T_775ec_row5_col4, #T_775ec_row6_col0, #T_775ec_row6_col1, #T_775ec_row6_col2, #T_775ec_row6_col3, #T_775ec_row6_col4, #T_775ec_row7_col0, #T_775ec_row7_col1, #T_775ec_row7_col2, #T_775ec_row7_col3, #T_775ec_row7_col4, #T_775ec_row8_col0, #T_775ec_row8_col1, #T_775ec_row8_col2, #T_775ec_row8_col3, #T_775ec_row8_col4, #T_775ec_row9_col2, #T_775ec_row10_col1 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row1_col2 {
  background-color: rgb(27,88,51);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row1_col3 {
  background-color: rgb(46,102,67);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row1_col4 {
  background-color: rgb(109,149,123);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row2_col2 {
  background-color: rgb(52,107,73);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row2_col3 {
  background-color: rgb(55,109,75);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row2_col4 {
  background-color: rgb(100,142,115);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row4_col0 {
  background-color: rgb(67,118,86);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row4_col1 {
  background-color: rgb(97,140,112);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row4_col3 {
  background-color: rgb(193,212,198);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row9_col0 {
  background-color: rgb(129,164,141);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row9_col3 {
  background-color: rgb(185,206,190);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row9_col4 {
  background-color: rgb(182,204,188);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row10_col0 {
  background-color: rgb(52,106,72);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row10_col3 {
  background-color: rgb(116,155,130);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_775ec_row10_col4 {
  background-color: rgb(181,203,187);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_775ec">
  <caption>Segment Analysis for Customer State</caption>
  <thead>
    <tr>
      <th class="index_name level0" >customer_state</th>
      <th id="T_775ec_level0_col0" class="col_heading level0 col0" >Rio de Janeiro</th>
      <th id="T_775ec_level0_col1" class="col_heading level0 col1" >Sao Paulo</th>
      <th id="T_775ec_level0_col2" class="col_heading level0 col2" >Rio Grande do Sul</th>
      <th id="T_775ec_level0_col3" class="col_heading level0 col3" >Minas Gerais</th>
      <th id="T_775ec_level0_col4" class="col_heading level0 col4" >Parana</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_775ec_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_775ec_row0_col0" class="data row0 col0" >12.87%</td>
      <td id="T_775ec_row0_col1" class="data row0 col1" >41.95%</td>
      <td id="T_775ec_row0_col2" class="data row0 col2" >5.48%</td>
      <td id="T_775ec_row0_col3" class="data row0 col3" >11.71%</td>
      <td id="T_775ec_row0_col4" class="data row0 col4" >5.08%</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_775ec_row1_col0" class="data row1 col0" >115.45</td>
      <td id="T_775ec_row1_col1" class="data row1 col1" >96.46</td>
      <td id="T_775ec_row1_col2" class="data row1 col2" >113.35</td>
      <td id="T_775ec_row1_col3" class="data row1 col3" >111.91</td>
      <td id="T_775ec_row1_col4" class="data row1 col4" >107.01</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_775ec_row2_col0" class="data row2 col0" >113.11</td>
      <td id="T_775ec_row2_col1" class="data row2 col1" >93.85</td>
      <td id="T_775ec_row2_col2" class="data row2 col2" >108.99</td>
      <td id="T_775ec_row2_col3" class="data row2 col3" >108.81</td>
      <td id="T_775ec_row2_col4" class="data row2 col4" >105.28</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_775ec_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_775ec_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_775ec_row3_col2" class="data row3 col2" >1.00</td>
      <td id="T_775ec_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_775ec_row3_col4" class="data row3 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_775ec_row4_col0" class="data row4 col0" >40.06</td>
      <td id="T_775ec_row4_col1" class="data row4 col1" >38.67</td>
      <td id="T_775ec_row4_col2" class="data row4 col2" >43.20</td>
      <td id="T_775ec_row4_col3" class="data row4 col3" >34.15</td>
      <td id="T_775ec_row4_col4" class="data row4 col4" >31.67</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_775ec_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_775ec_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_775ec_row5_col2" class="data row5 col2" >5.00</td>
      <td id="T_775ec_row5_col3" class="data row5 col3" >5.00</td>
      <td id="T_775ec_row5_col4" class="data row5 col4" >5.00</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_775ec_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_775ec_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_775ec_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_775ec_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_775ec_row6_col4" class="data row6 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_775ec_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_775ec_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_775ec_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_775ec_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_775ec_row7_col4" class="data row7 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_775ec_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_775ec_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_775ec_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_775ec_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_775ec_row8_col4" class="data row8 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_775ec_row9_col0" class="data row9 col0" >-12.24</td>
      <td id="T_775ec_row9_col1" class="data row9 col1" >-10.27</td>
      <td id="T_775ec_row9_col2" class="data row9 col2" >-14.03</td>
      <td id="T_775ec_row9_col3" class="data row9 col3" >-13.09</td>
      <td id="T_775ec_row9_col4" class="data row9 col4" >-13.05</td>
    </tr>
    <tr>
      <th id="T_775ec_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_775ec_row10_col0" class="data row10 col0" >0.85</td>
      <td id="T_775ec_row10_col1" class="data row10 col1" >0.70</td>
      <td id="T_775ec_row10_col2" class="data row10 col2" >0.89</td>
      <td id="T_775ec_row10_col3" class="data row10 col3" >0.80</td>
      <td id="T_775ec_row10_col4" class="data row10 col4" >0.75</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/52c5d78794e5a527b58bcc54910a809d535bb35e8c94b33e621483bef0b1d955.jpg" src="../../_images/52c5d78794e5a527b58bcc54910a809d535bb35e8c94b33e621483bef0b1d955.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Customer distribution by state:</p>
<ul>
<li><p>São Paulo: 42%</p></li>
<li><p>Rio de Janeiro: 13%</p></li>
<li><p>Minas Gerais: 12%</p></li>
</ul>
</li>
</ul>
<p><strong>By Customer City</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_polar</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_city&#39;</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels_for_polar</span>
<span class="p">)</span>
<span class="n">pb</span><span class="o">.</span><span class="n">to_slide</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_customers</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">segment_table</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="n">selected_metrics</span>
    <span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;customer_city&#39;</span>
    <span class="p">,</span> <span class="n">max_segments</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">exclude_segments</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Never Converted&#39;</span><span class="p">]</span>
    <span class="p">,</span> <span class="n">count_column</span><span class="o">=</span><span class="s1">&#39;customer_unique_id&#39;</span> 
<span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_1a545 caption {
  font-size: 16px;
  text-align: left;
  font-weight: bold;
  white-space: nowrap;
}
#T_1a545 th {
  border: 1px solid black;
}
#T_1a545_row0_col0, #T_1a545_row1_col1, #T_1a545_row2_col1, #T_1a545_row4_col1, #T_1a545_row9_col0, #T_1a545_row10_col1 {
  background-color: rgb(0,68,27);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row0_col1 {
  background-color: rgb(153,182,162);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row0_col2 {
  background-color: rgb(224,235,225);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row0_col3 {
  background-color: rgb(235,243,235);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row0_col4, #T_1a545_row1_col0, #T_1a545_row2_col0, #T_1a545_row3_col0, #T_1a545_row3_col1, #T_1a545_row3_col2, #T_1a545_row3_col3, #T_1a545_row3_col4, #T_1a545_row4_col4, #T_1a545_row5_col0, #T_1a545_row5_col1, #T_1a545_row5_col2, #T_1a545_row5_col3, #T_1a545_row5_col4, #T_1a545_row6_col0, #T_1a545_row6_col1, #T_1a545_row6_col2, #T_1a545_row6_col3, #T_1a545_row6_col4, #T_1a545_row7_col0, #T_1a545_row7_col1, #T_1a545_row7_col2, #T_1a545_row7_col3, #T_1a545_row7_col4, #T_1a545_row8_col0, #T_1a545_row8_col1, #T_1a545_row8_col2, #T_1a545_row8_col3, #T_1a545_row8_col4, #T_1a545_row9_col1, #T_1a545_row9_col4, #T_1a545_row10_col3 {
  background-color: rgb(247,252,245);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row1_col2, #T_1a545_row1_col4 {
  background-color: rgb(84,130,101);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row1_col3, #T_1a545_row2_col3 {
  background-color: rgb(15,79,40);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row2_col2 {
  background-color: rgb(75,124,93);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row2_col4 {
  background-color: rgb(80,127,97);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row4_col0 {
  background-color: rgb(10,76,36);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row4_col2 {
  background-color: rgb(66,117,85);
  color: white;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row4_col3 {
  background-color: rgb(202,218,205);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row9_col2 {
  background-color: rgb(182,203,187);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row9_col3 {
  background-color: rgb(164,190,172);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row10_col0 {
  background-color: rgb(197,215,201);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row10_col2 {
  background-color: rgb(108,148,122);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
#T_1a545_row10_col4 {
  background-color: rgb(148,178,157);
  color: black;
  border: 1px solid black;
  text-align: center;
  padding: 5px;
  font-size: 12px;
}
</style>
<table id="T_1a545">
  <caption>Segment Analysis for Customer City</caption>
  <thead>
    <tr>
      <th class="index_name level0" >customer_city</th>
      <th id="T_1a545_level0_col0" class="col_heading level0 col0" >Sao Paulo</th>
      <th id="T_1a545_level0_col1" class="col_heading level0 col1" >Rio De Janeiro</th>
      <th id="T_1a545_level0_col2" class="col_heading level0 col2" >Belo Horizonte</th>
      <th id="T_1a545_level0_col3" class="col_heading level0 col3" >Brasilia</th>
      <th id="T_1a545_level0_col4" class="col_heading level0 col4" >Curitiba</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_1a545_level0_row0" class="row_heading level0 row0" >% of Total Count</th>
      <td id="T_1a545_row0_col0" class="data row0 col0" >15.60%</td>
      <td id="T_1a545_row0_col1" class="data row0 col1" >6.87%</td>
      <td id="T_1a545_row0_col2" class="data row0 col2" >2.78%</td>
      <td id="T_1a545_row0_col3" class="data row0 col3" >2.15%</td>
      <td id="T_1a545_row0_col4" class="data row0 col4" >1.52%</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row1" class="row_heading level0 row1" >total_customer_payment</th>
      <td id="T_1a545_row1_col0" class="data row1 col0" >94.31</td>
      <td id="T_1a545_row1_col1" class="data row1 col1" >113.44</td>
      <td id="T_1a545_row1_col2" class="data row1 col2" >106.90</td>
      <td id="T_1a545_row1_col3" class="data row1 col3" >112.24</td>
      <td id="T_1a545_row1_col4" class="data row1 col4" >106.90</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row2" class="row_heading level0 row2" >avg_total_order_payment</th>
      <td id="T_1a545_row2_col0" class="data row2 col0" >92.46</td>
      <td id="T_1a545_row2_col1" class="data row2 col1" >110.44</td>
      <td id="T_1a545_row2_col2" class="data row2 col2" >104.96</td>
      <td id="T_1a545_row2_col3" class="data row2 col3" >109.32</td>
      <td id="T_1a545_row2_col4" class="data row2 col4" >104.61</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row3" class="row_heading level0 row3" >buys_cnt</th>
      <td id="T_1a545_row3_col0" class="data row3 col0" >1.00</td>
      <td id="T_1a545_row3_col1" class="data row3 col1" >1.00</td>
      <td id="T_1a545_row3_col2" class="data row3 col2" >1.00</td>
      <td id="T_1a545_row3_col3" class="data row3 col3" >1.00</td>
      <td id="T_1a545_row3_col4" class="data row3 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row4" class="row_heading level0 row4" >from_first_to_last_days</th>
      <td id="T_1a545_row4_col0" class="data row4 col0" >40.99</td>
      <td id="T_1a545_row4_col1" class="data row4 col1" >42.73</td>
      <td id="T_1a545_row4_col2" class="data row4 col2" >32.09</td>
      <td id="T_1a545_row4_col3" class="data row4 col3" >10.50</td>
      <td id="T_1a545_row4_col4" class="data row4 col4" >3.33</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row5" class="row_heading level0 row5" >customer_avg_reviews_score</th>
      <td id="T_1a545_row5_col0" class="data row5 col0" >5.00</td>
      <td id="T_1a545_row5_col1" class="data row5 col1" >5.00</td>
      <td id="T_1a545_row5_col2" class="data row5 col2" >5.00</td>
      <td id="T_1a545_row5_col3" class="data row5 col3" >5.00</td>
      <td id="T_1a545_row5_col4" class="data row5 col4" >5.00</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row6" class="row_heading level0 row6" >canceled_share</th>
      <td id="T_1a545_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_1a545_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_1a545_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_1a545_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_1a545_row6_col4" class="data row6 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row7" class="row_heading level0 row7" >purchase_weekend_share</th>
      <td id="T_1a545_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_1a545_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_1a545_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_1a545_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_1a545_row7_col4" class="data row7 col4" >0.00</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row8" class="row_heading level0 row8" >avg_products_cnt</th>
      <td id="T_1a545_row8_col0" class="data row8 col0" >1.00</td>
      <td id="T_1a545_row8_col1" class="data row8 col1" >1.00</td>
      <td id="T_1a545_row8_col2" class="data row8 col2" >1.00</td>
      <td id="T_1a545_row8_col3" class="data row8 col3" >1.00</td>
      <td id="T_1a545_row8_col4" class="data row8 col4" >1.00</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row9" class="row_heading level0 row9" >avg_delivery_delay_days</th>
      <td id="T_1a545_row9_col0" class="data row9 col0" >-10.04</td>
      <td id="T_1a545_row9_col1" class="data row9 col1" >-13.05</td>
      <td id="T_1a545_row9_col2" class="data row9 col2" >-12.26</td>
      <td id="T_1a545_row9_col3" class="data row9 col3" >-12.05</td>
      <td id="T_1a545_row9_col4" class="data row9 col4" >-13.05</td>
    </tr>
    <tr>
      <th id="T_1a545_level0_row10" class="row_heading level0 row10" >avg_order_total_weight_kg</th>
      <td id="T_1a545_row10_col0" class="data row10 col0" >0.65</td>
      <td id="T_1a545_row10_col1" class="data row10 col1" >0.85</td>
      <td id="T_1a545_row10_col2" class="data row10 col2" >0.74</td>
      <td id="T_1a545_row10_col3" class="data row10 col3" >0.60</td>
      <td id="T_1a545_row10_col4" class="data row10 col4" >0.70</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/718909bff44db3e65b88fc7739eb386c44a6f54296e25b03239d8f5a3abd5b77.jpg" src="../../_images/718909bff44db3e65b88fc7739eb386c44a6f54296e25b03239d8f5a3abd5b77.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Customer distribution by city:</p>
<ul>
<li><p>São Paulo: 16%</p></li>
<li><p>Rio de Janeiro: 7%</p></li>
</ul>
</li>
</ul>
</section>
<section id="customer-profiling">
<h2>Customer Profiling<a class="headerlink" href="#customer-profiling" title="Link to this heading">#</a></h2>
<p><strong>By Purchase Frequency &amp; Loyalty</strong></p>
<ul class="simple">
<li><p><strong>One-Time Buyers (94%):</strong></p>
<ul>
<li><p>Single purchase only</p></li>
<li><p>Low engagement (short time between purchases)</p></li>
</ul>
</li>
<li><p><strong>Potential Core (1%):</strong></p>
<ul>
<li><p>Potentially loyal but not yet core</p></li>
<li><p>Strong metrics (second only to Core)</p></li>
</ul>
</li>
<li><p><strong>Core (&lt;1%):</strong></p>
<ul>
<li><p>Loyalty core: highest spending, best metrics</p></li>
</ul>
</li>
<li><p><strong>Short-Lived Repeat (1%):</strong></p>
<ul>
<li><p>Short-term loyalty</p></li>
</ul>
</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ol class="arabic simple">
<li><p>Convert One-Time to Potential Core:</p>
<ul class="simple">
<li><p>Launch loyalty programs</p></li>
<li><p>Personalized offers based on first purchase</p></li>
</ul>
</li>
<li><p>Retain Core customers:</p>
<ul class="simple">
<li><p>Premium service tier</p></li>
<li><p>Exclusive early access to sales</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
<p><strong>By Payment Amount</strong></p>
<ul class="simple">
<li><p><strong>High-Spend (24%):</strong></p>
<ul>
<li><p>Large orders</p></li>
<li><p>Heavy items</p></li>
<li><p>Critical risk</p></li>
</ul>
</li>
<li><p><strong>Medium-Spend (49%):</strong></p>
<ul>
<li><p>Stable base</p></li>
<li><p>Balanced metrics</p></li>
</ul>
</li>
<li><p><strong>Low-Spend (24%):</strong></p>
<ul>
<li><p>Small orders</p></li>
<li><p>Likely trial purchases</p></li>
</ul>
</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ol class="arabic simple">
<li><p>For High-Spend:</p>
<ul class="simple">
<li><p>Improve delivery (current avg. 18 days)</p></li>
<li><p>Dedicated account managers</p></li>
</ul>
</li>
<li><p>For Low-Spend:</p>
<ul class="simple">
<li><p>Cross-sell bundles (+15% discount)</p></li>
<li><p>“Complete your set” prompts</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
<p><strong>By Repurchase Timing</strong></p>
<ul class="simple">
<li><p><strong>Fast Repeat (&lt;1%):</strong></p>
<ul>
<li><p>Quick repurchase</p></li>
<li><p>Low satisfaction</p></li>
</ul>
</li>
<li><p><strong>Seasonal (1%):</strong></p>
<ul>
<li><p>Quarterly/semi-annual purchases</p></li>
<li><p>High value</p></li>
</ul>
</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ol class="arabic simple">
<li><p>For Fast Repeat:</p>
<ul class="simple">
<li><p>Post-purchase follow-ups</p></li>
<li><p>Satisfaction surveys</p></li>
</ul>
</li>
<li><p>For Seasonal:</p>
<ul class="simple">
<li><p>Pre-season reminders</p></li>
<li><p>“Back in stock” alerts</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
<p><strong>By Loyalty</strong></p>
<ul class="simple">
<li><p><strong>Promoters (58%):</strong></p>
<ul>
<li><p>High ratings (4-5 stars)</p></li>
<li><p>Low retention (94% one-time)</p></li>
</ul>
</li>
<li><p><strong>Critics (13%):</strong></p>
<ul>
<li><p>High spenders</p></li>
<li><p>Fast churn</p></li>
</ul>
</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ol class="arabic simple">
<li><p>For Promoters:</p>
<ul class="simple">
<li><p>“Refer a friend” bonuses</p></li>
<li><p>Repeat purchase incentives</p></li>
</ul>
</li>
<li><p>For Critics:</p>
<ul class="simple">
<li><p>Logistics improvements</p></li>
<li><p>VIP complaint resolution</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
<p><strong>Behavioral Patterns</strong></p>
<ul class="simple">
<li><p>Customers who made purchases not only on weekends (25%):</p>
<ul>
<li><p>More loyal (longer time between purchases).</p></li>
</ul>
</li>
<li><p>Customers who use installment payments (50%):</p>
<ul>
<li><p>Higher order amounts, longer customer lifetime — “serious” customers.</p></li>
</ul>
</li>
<li><p>Customers with 2+ products in an order (2%):</p>
<ul>
<li><p>Key for revenue (high metrics).</p></li>
</ul>
</li>
<li><p>Customers who use only a voucher:</p>
<ul>
<li><p>Have lower total purchase amounts and average order amounts.</p></li>
</ul>
</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ul class="simple">
<li><p>Installment campaigns:</p>
<ul>
<li><p>“0% interest for 3 months”</p></li>
</ul>
</li>
<li><p>Multi-item incentives:</p>
<ul>
<li><p>“Free shipping on 3+ items”</p></li>
</ul>
</li>
<li><p>Voucher users:</p>
<ul>
<li><p>Upsell to credit card payments</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>By Geographic</strong></p>
<ul class="simple">
<li><p><strong>São Paulo (42%):</strong></p>
<ul>
<li><p>Electronics/Furniture focus</p></li>
<li><p>18% faster delivery than average</p></li>
</ul>
</li>
<li><p><strong>Rio de Janeiro (13%):</strong></p>
<ul>
<li><p>High Fashion/Beauty demand</p></li>
<li><p>22% installment adoption</p></li>
</ul>
</li>
</ul>
<p><strong>Recommendations:</strong></p>
<ol class="arabic simple">
<li><p>Localized campaigns:</p>
<ul class="simple">
<li><p>“SP Furniture Week” discounts</p></li>
<li><p>“Rio Beauty Box” bundles</p></li>
</ul>
</li>
<li><p>Warehouse optimization:</p>
<ul class="simple">
<li><p>Strategic stock placement</p></li>
<li><p>Regional delivery hubs</p></li>
</ul>
</li>
</ol>
</section>
<section id="pairwise-segment-combinations">
<h2>Pairwise Segment Combinations<a class="headerlink" href="#pairwise-segment-combinations" title="Link to this heading">#</a></h2>
<p>Examine the distribution of customers across combinations of 2 segments.</p>
<p>We will exclude the non-converted segment from the analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df_customers</span><span class="p">[</span><span class="n">df_customers</span><span class="o">.</span><span class="n">buys_cnt</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
    <span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;customer_unique_id&#39;</span>
    <span class="p">,</span> <span class="n">metric_label</span> <span class="o">=</span> <span class="s1">&#39;Share of Customers&#39;</span>
    <span class="p">,</span> <span class="n">agg_func</span> <span class="o">=</span> <span class="s1">&#39;nunique&#39;</span>
    <span class="p">,</span> <span class="n">norm_by</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>
    <span class="p">,</span> <span class="n">axis_sort_order</span><span class="o">=</span><span class="s1">&#39;descending&#39;</span>    
    <span class="p">,</span> <span class="n">text_auto</span><span class="o">=</span><span class="s1">&#39;.1%&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>loyalty_segment and value_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;loyalty_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;value_segment&#39;</span>
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6f65e740fd1e8da7a17972f344fea4bd3681c275a5639ae88561fe23a6e030a0.jpg" src="../../_images/6f65e740fd1e8da7a17972f344fea4bd3681c275a5639ae88561fe23a6e030a0.jpg" />
<img alt="../../_images/f6da2a7d08ba94c3a1328f3410a5da969dae6a3d79f36d8d8a2f3618c32d9338.jpg" src="../../_images/f6da2a7d08ba94c3a1328f3410a5da969dae6a3d79f36d8d8a2f3618c32d9338.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>The medium payment tier dominates across all loyalty segments.</p></li>
<li><p>Promoters are the majority in all payment tiers.</p></li>
<li><p>Critics stand out noticeably in the high payment tier segment.</p></li>
</ul>
<p><strong>purchase_freq_segment and value_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;purchase_freq_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;value_segment&#39;</span>
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/461f6bdd93bd6376ce206c14a7a0dab86d2dab1049b33ece6f3f943fc5c67d8d.jpg" src="../../_images/461f6bdd93bd6376ce206c14a7a0dab86d2dab1049b33ece6f3f943fc5c67d8d.jpg" />
<img alt="../../_images/9b71422a5784e0586beaf214fc8a0abe017e193476b7771410fc5ecacd09364d.jpg" src="../../_images/9b71422a5784e0586beaf214fc8a0abe017e193476b7771410fc5ecacd09364d.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>The low Value segment has a significantly higher proportion of non-repeat purchasers (logical since they don’t make repeat purchases).</p></li>
<li><p>In the high Value segment, the weekly purchase frequency segment underperforms - meaning fewer purchases occurred weekly.</p></li>
</ul>
<p><strong>activity_segment and repeat_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;activity_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;repeat_segment&#39;</span>
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/695c0b536a1d8be7d4e4e15661d5cd3736436adee759b3ecca2dbf4a80862c6b.jpg" src="../../_images/695c0b536a1d8be7d4e4e15661d5cd3736436adee759b3ecca2dbf4a80862c6b.jpg" />
<img alt="../../_images/5145a8ac1ae6705b39d4650c21d6ab6319c85527df27ea97a6460d35dac85b10.jpg" src="../../_images/5145a8ac1ae6705b39d4650c21d6ab6319c85527df27ea97a6460d35dac85b10.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>The slow repeat segment is clearly highlighted in potential core, meaning they have a long time between repeat purchases. The same pattern is present in the core segment, but it is less pronounced.</p></li>
</ul>
<p><strong>loyalty_segment and risk_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;loyalty_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;risk_segment&#39;</span>
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ead18e6344cee6c988a50a19ca8a504cdb8047975c50530dd0712942cd2f77d7.jpg" src="../../_images/ead18e6344cee6c988a50a19ca8a504cdb8047975c50530dd0712942cd2f77d7.jpg" />
<img alt="../../_images/134d2aa901c425f35a97eb25f96655674221c1daa823f51faea5b39e461df029.jpg" src="../../_images/134d2aa901c425f35a97eb25f96655674221c1daa823f51faea5b39e461df029.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>The potential core cohort clearly highlights the slow repeat segment, indicating a longer time period before repeat purchases. In the core cohort, the same pattern is observed, but it is less pronounced.</p></li>
</ul>
<p><strong>customer_top_general_product_categories and value_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;customer_top_general_product_categories&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;value_segment&#39;</span>
    <span class="p">,</span> <span class="n">trim_top_n_cat1</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7d586186adedf6892675bf01925f5fa45b3b6d8073a1e149a799650f1bdf9f84.jpg" src="../../_images/7d586186adedf6892675bf01925f5fa45b3b6d8073a1e149a799650f1bdf9f84.jpg" />
<img alt="../../_images/c81f166d6ffae1591f8643284ffdca4314c4fea177d1a7178519c06d50b9f750.jpg" src="../../_images/c81f166d6ffae1591f8643284ffdca4314c4fea177d1a7178519c06d50b9f750.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Electronics dominate purchases in the low Value segment, while medium Value segments show noticeably fewer electronics purchases.</p></li>
</ul>
<p><strong>weight_segment and customer_state</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;weight_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;customer_state&#39;</span> 
    <span class="p">,</span> <span class="n">trim_top_n_cat2</span><span class="o">=</span><span class="mi">5</span>
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/67105dad040104d8f2e5421c58f223e6a7f58649b6a3144994b73c91e89421c0.jpg" src="../../_images/67105dad040104d8f2e5421c58f223e6a7f58649b6a3144994b73c91e89421c0.jpg" />
<img alt="../../_images/b9edd4332c18ea33fbc2312d9aaa7835abfd46c7b2b9673f9f6d6445baca67bc.jpg" src="../../_images/b9edd4332c18ea33fbc2312d9aaa7835abfd46c7b2b9673f9f6d6445baca67bc.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>São Paulo has more light-weight orders while Rio de Janeiro has more heavy-weight orders.</p></li>
</ul>
<p><strong>weekday_segment and activity_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;weekday_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;activity_segment&#39;</span> 
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/065c84e7fe00bfb3ca19b37bf2bccb6456f03167cd6ed5709a6d3e137f65a5af.jpg" src="../../_images/065c84e7fe00bfb3ca19b37bf2bccb6456f03167cd6ed5709a6d3e137f65a5af.jpg" />
<img alt="../../_images/ebcb1e2ca6306239b5ceb76baa2b9e10aeb0a4e404b23e90714334d54c361e12.jpg" src="../../_images/ebcb1e2ca6306239b5ceb76baa2b9e10aeb0a4e404b23e90714334d54c361e12.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Core and potential core segments contain more customers who shop beyond just weekdays, while one-time purchasers predominantly shop on weekdays.</p></li>
</ul>
<p><strong>products_cnt_segment and loyalty_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;products_cnt_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;loyalty_segment&#39;</span> 
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a71d130ce4033f2c2142be1925af276636dbcda026822189415eb523eae37df8.jpg" src="../../_images/a71d130ce4033f2c2142be1925af276636dbcda026822189415eb523eae37df8.jpg" />
<img alt="../../_images/b79e3cdcd5a1c4f8604654bd0b46c434033db4e65584d25c2df48c82ead31926.jpg" src="../../_images/b79e3cdcd5a1c4f8604654bd0b46c434033db4e65584d25c2df48c82ead31926.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>Single-product orders dominate among promoters, while critics tend to have more 2+ product orders.</p></li>
</ul>
<p><strong>installment_segment and repeat_segment</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pb</span><span class="o">.</span><span class="n">cat_compare</span><span class="p">(</span>
    <span class="n">cat1</span><span class="o">=</span><span class="s1">&#39;installment_segment&#39;</span>
    <span class="p">,</span> <span class="n">cat2</span> <span class="o">=</span> <span class="s1">&#39;repeat_segment&#39;</span> 
    <span class="p">,</span> <span class="n">visible_graphs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/81d1cda13bdf9b3b077aac0dc0cec5f1711ea373788526814e1e1ec62e74cc7f.jpg" src="../../_images/81d1cda13bdf9b3b077aac0dc0cec5f1711ea373788526814e1e1ec62e74cc7f.jpg" />
<img alt="../../_images/f053467fa2982158ea4c21546dc86bb8bcdaf79f606c7dd8c0235ce1b11925aa.jpg" src="../../_images/f053467fa2982158ea4c21546dc86bb8bcdaf79f606c7dd8c0235ce1b11925aa.jpg" />
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ul class="simple">
<li><p>The installment segment contains more customers with longer periods between repeat purchases.</p></li>
<li><p>The non-installment segment shows:</p>
<ul>
<li><p>Lower proportion of long repeat purchase cycles</p></li>
<li><p>Dominance of one-time purchasers</p></li>
</ul>
</li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="13_slice_analysis.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Slice Analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="15_rfm_analysis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">RFM Analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-customers-by-segments">Distribution of Customers by Segments</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customer-profiling">Customer Profiling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pairwise-segment-combinations">Pairwise Segment Combinations</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Pavel Grigoryev
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Pavel Grigoryev.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>